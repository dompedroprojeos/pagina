<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulação de Código - Sistema de Estoque</title>
    <style>
        body {
            background-color: #1e1e1e;
            margin: 0;
            padding: 20px;
            font-family: 'Consolas', 'Courier New', monospace;
            color: #d4d4d4;
            overflow: hidden;
        }
        
        .editor {
            background-color: #1e1e1e;
            border-radius: 5px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
            max-width: 800px;
            margin: 0 auto;
            overflow: hidden;
        }
        
        .title-bar {
            background-color: #3c3c3c;
            padding: 8px 15px;
            display: flex;
            align-items: center;
        }
        
        .dots {
            display: flex;
            margin-right: 15px;
        }
        
        .dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .dot-red { background-color: #ff5f56; }
        .dot-yellow { background-color: #ffbd2e; }
        .dot-green { background-color: #27c93f; }
        
        .file-name {
            font-size: 13px;
            color: #b0b0b0;
        }
        
        .code-container {
            padding: 15px;
            position: relative;
        }
        
        .line-numbers {
            position: absolute;
            left: 15px;
            top: 15px;
            color: #858585;
            text-align: right;
            user-select: none;
        }
        
        .code {
            margin-left: 40px;
            white-space: pre;
            overflow: hidden;
            font-size: 14px;
            line-height: 1.5;
            tab-size: 2;
        }
        
        .cursor {
            display: inline-block;
            width: 8px;
            height: 16px;
            background-color: #d4d4d4;
            animation: blink 1s infinite;
            vertical-align: middle;
        }
        
        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0; }
        }
        
        .keyword { color: #569cd6; }
        .function { color: #dcdcaa; }
        .string { color: #ce9178; }
        .comment { color: #6a9955; }
        .number { color: #b5cea8; }
        .operator { color: #d4d4d4; }
        .variable { color: #9cdcfe; }
        .type { color: #4ec9b0; }
    </style>
</head>
<body>
    <div class="editor">
        <div class="title-bar">
            <div class="dots">
                <div class="dot dot-red"></div>
                <div class="dot dot-yellow"></div>
                <div class="dot dot-green"></div>
            </div>
            <div class="file-name">estoque.js</div>
        </div>
        <div class="code-container">
            <div class="line-numbers" id="line-numbers">1</div>
            <div class="code" id="code"></div>
        </div>
    </div>

    <script>
        // Código que será "digitado"
        const fullCode = [
`class Produto {`,
`  constructor(id, nome, quantidade, preco) {`,
`    this.id = id;`,
`    this.nome = nome;`,
`    this.quantidade = quantidade;`,
`    this.preco = preco;`,
`  }`,
`}`,
``,
`class Estoque {`,
`  constructor() {`,
`    this.produtos = [];`,
`    this.ultimoId = 0;`,
`  }`,
``,
`  // Adiciona um novo produto ao estoque`,
`  adicionarProduto(nome, quantidade, preco) {`,
`    this.ultimoId++;`,
`    const novoProduto = new Produto(`,
`      this.ultimoId,`,
`      nome,`,
`      quantidade,`,
`      preco`,
`    );`,
`    this.produtos.push(novoProduto);`,
`    return novoProduto;`,
`  }`,
``,
`  // Remove produto pelo ID`,
`  removerProduto(id) {`,
`    const index = this.produtos.findIndex(p => p.id === id);`,
`    if (index !== -1) {`,
`      return this.produtos.splice(index, 1)[0];`,
`    }`,
`    return null;`,
`  }`,
``,
`  // Atualiza quantidade de um produto`,
`  atualizarQuantidade(id, novaQuantidade) {`,
`    const produto = this.produtos.find(p => p.id === id);`,
`    if (produto) {`,
`      produto.quantidade = novaQuantidade;`,
`      return true;`,
`    }`,
`    return false;`,
`  }`,
``,
`  // Lista todos os produtos`,
`  listarProdutos() {`,
`    return [...this.produtos];`,
`  }`,
``,
`  // Busca produto por nome (case insensitive)`,
`  buscarPorNome(termo) {`,
`    const termoLower = termo.toLowerCase();`,
`    return this.produtos.filter(p => `,
`      p.nome.toLowerCase().includes(termoLower)`,
`    );`,
`  }`,
``,
`  // Calcula valor total do estoque`,
`  calcularValorTotal() {`,
`    return this.produtos.reduce(`,
`      (total, produto) => total + (produto.quantidade * produto.preco),`,
`      0`,
`    );`,
`  }`,
`}`,
``,
`// Exemplo de uso:`,
`const meuEstoque = new Estoque();`,
``,
`meuEstoque.adicionarProduto("Notebook Dell", 10, 4500.00);`,
`meuEstoque.adicionarProduto("Mouse Sem Fio", 50, 120.00);`,
`meuEstoque.adicionarProduto("Teclado Mecânico", 25, 350.00);`,
``,
`console.log("Valor total do estoque:", `,
`  meuEstoque.calcularValorTotal().toLocaleString('pt-BR', {`,
`    style: 'currency',`,
`    currency: 'BRL'`,
`  })`,
`);`,
``,
`// Saída esperada:`,
`// Valor total do estoque: R$ 62.000,00`];

        // Função para adicionar syntax highlighting
        function highlightCode(code) {
            return code
                .replace(/(\/\/.*$)/gm, '<span class="comment">$1</span>')
                .replace(/\b(class|constructor|return|new|if|else|const|let|var)\b/g, '<span class="keyword">$1</span>')
                .replace(/\b(Produto|Estoque|true|false|null)\b/g, '<span class="type">$1</span>')
                .replace(/\b(adicionarProduto|removerProduto|atualizarQuantidade|listarProdutos|buscarPorNome|calcularValorTotal|findIndex|find|filter|reduce|push|splice|toLowerCase|includes|toLocaleString)\b/g, '<span class="function">$1</span>')
                .replace(/"([^"]*)"/g, '<span class="string">"$1"</span>')
                .replace(/\b(\d+)\b/g, '<span class="number">$1</span>')
                .replace(/([{}()[\];=,+\-*\/])/g, '<span class="operator">$1</span>')
                .replace(/(this\.\w+)/g, '<span class="variable">$1</span>');
        }

        // Elementos do DOM
        const codeElement = document.getElementById('code');
        const lineNumbersElement = document.getElementById('line-numbers');
        
        // Variáveis de controle
        let currentLine = 0;
        let currentChar = 0;
        let typingSpeed = 20; // ms por caractere
        let newLineDelay = 500; // ms após cada linha
        
        // Função principal para "digitar" o código
        function typeCode() {
            if (currentLine < fullCode.length) {
                const line = fullCode[currentLine];
                
                if (currentChar < line.length) {
                    // Adiciona próximo caractere
                    const char = line.charAt(currentChar);
                    codeElement.innerHTML = highlightCode(
                        codeElement.textContent + char
                    ) + '<span class="cursor"></span>';
                    currentChar++;
                    
                    // Atualiza números das linhas
                    updateLineNumbers();
                    
                    // Agenda próximo caractere
                    setTimeout(typeCode, typingSpeed);
                } else {
                    // Muda para próxima linha
                    codeElement.innerHTML = highlightCode(
                        codeElement.textContent + '\n'
                    ) + '<span class="cursor"></span>';
                    currentLine++;
                    currentChar = 0;
                    
                    // Atualiza números das linhas
                    updateLineNumbers();
                    
                    // Pequena pausa antes da próxima linha
                    setTimeout(typeCode, newLineDelay);
                }
            } else {
                // Código completo - mantém cursor piscando
                codeElement.innerHTML = highlightCode(codeElement.textContent) + 
                    '<span class="cursor"></span>';
            }
        }
        
        // Atualiza os números das linhas
        function updateLineNumbers() {
            const lineCount = codeElement.textContent.split('\n').length;
            let numbers = '';
            for (let i = 1; i <= lineCount; i++) {
                numbers += i + '\n';
            }
            lineNumbersElement.textContent = numbers;
        }
        
        // Inicia a animação
        setTimeout(typeCode, 1000);
    </script>
</body>
</html>
