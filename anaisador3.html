<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Vendas por Forma de Pagamento</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.12.313/pdf.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: 10px;
            font-family: 'Inter', sans-serif;
        }

        .dashboard-container {
            max-width: 99% !important;
            margin: 0 auto;
            padding: 8px;
        }

        .table-container {
            width: 100%;
            overflow-x: auto;
        }

        .modern-table {
            width: 100%;
            table-layout: auto;
        }

        .header-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px 20px 0 0;
        }

        .logo-container {
            width: 60px;
            height: 60px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .stat-card {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 10px 25px -3px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.8);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px -3px rgba(0, 0, 0, 0.15);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 16px 16px 0 0;
        }

        .action-button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            border: none;
            border-radius: 12px;
            color: white;
            padding: 12px 24px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
        }

        .action-button.secondary {
            background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
            box-shadow: 0 4px 15px rgba(139, 92, 246, 0.4);
        }

        .action-button.secondary:hover {
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.6);
        }

        .action-button.danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.4);
        }

        .action-button.danger:hover {
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.6);
        }

        .file-input {
            position: relative;
            overflow: hidden;
            display: inline-block;
            cursor: pointer;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border: 2px dashed #cbd5e1;
            border-radius: 16px;
            padding: 32px;
            text-align: center;
            transition: all 0.3s ease;
            width: 100%;
        }

        .file-input:hover {
            border-color: #667eea;
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
        }

        .file-input input[type=file] {
            position: absolute;
            left: -9999px;
        }

        .table-container {
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 25px -3px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.8);
            overflow: hidden;
        }

        .modern-table {
            width: 100%;
            border-collapse: collapse;
        }

        .modern-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 16px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
            letter-spacing: 0.5px;
        }

        .modern-table td {
            padding: 16px;
            border-bottom: 1px solid #f1f5f9;
            transition: all 0.3s ease;
            text-align: left !important;
        }

        .modern-table tr:hover td {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
        }

        .chart-container {
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 25px -3px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.8);
            position: relative;
        }

        .chart-3d {
            background: radial-gradient(circle at 50% 50%, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 16px;
            padding: 24px;
        }

        .pulse-animation {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .icon-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .glassmorphism {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
        }

        .checkbox-grid {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 16px;
            margin-bottom: 16px;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: #374151;
            cursor: pointer;
        }

        .checkbox-label input[type="checkbox"] {
            appearance: none;
            width: 20px;
            height: 20px;
            border: 2px solid #cbd5e1;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .checkbox-label input[type="checkbox"]:checked {
            border-color: #667eea;
            background-color: #667eea;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3E%3C/svg%3E");
        }

        .checkbox-label input[type="checkbox"]:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .search-input, .liters-input {
            background: white;
            border: 1px solid #cbd5e1;
            border-radius: 12px;
            padding: 12px;
            width: 100%;
            max-width: 300px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .search-input:focus, .liters-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .loading-spinner {
            border: 4px solid #f3f4f6;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .success-message {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 12px 24px;
            border-radius: 12px;
            margin: 16px 0;
            display: flex;
            align-items: center;
            gap: 8px;
            animation: slideIn 0.3s ease;
        }

        .print-values {
            display: none;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .hidden-column {
            display: none;
        }

        @media print {
            @page {
                size: landscape;
                margin: 0;
            }

            body {
                background: white;
                padding: 0;
                margin: 0;
                font-size: 10pt;
            }

            .no-print {
                display: none !important;
            }

            .dashboard-container {
                max-width: 100% !important;
                padding: 0 !important;
            }

            .header-gradient {
                border-radius: 0;
                padding: 10mm !important;
                position: relative;
                margin-bottom: 10mm;
            }

            .chart-container {
                page-break-inside: avoid;
                display: flex !important;
                flex-direction: row;
                align-items: center;
                justify-content: space-between;
                padding: 10mm !important;
                box-shadow: none;
                border: none;
            }

            #salesChart {
                width: 60% !important;
                height: auto !important;
            }

            .print-values {
                display: block !important;
                background: #f8fafc;
                border-radius: 8px;
                padding: 5mm !important;
                margin-left: 5mm !important;
                min-width: 80mm !important;
            }

            .print-values ul {
                list-style: none;
                margin: 0;
                padding: 0;
            }

            .print-values li {
                margin-bottom: 6px !important;
                font-size: 8pt !important;
                display: block;
                text-align: left !important;
            }

            .print-values strong {
                font-weight: 600;
            }

            .table-container {
                page-break-before: always;
                page-break-inside: avoid;
                box-shadow: none;
                border: none;
                margin-top: 10mm;
            }

            .modern-table {
                width: 100%;
                font-size: 8pt;
            }

            .modern-table th,
            .modern-table td {
                text-align: center !important;
                padding: 16px;
                border-bottom: 1px solid #f1f5f9;
                transition: all 0.3s ease;
            }

            .modern-table th:first-child,
            .modern-table td:first-child {
                text-align: left !important;
            }

            .print-header {
                position: running(header);
                text-align: center;
                font-size: 12pt;
                font-weight: bold;
                margin-bottom: 5mm;
            }

            .print-footer {
                position: running(footer);
                text-align: center;
                font-size: 8pt;
                color: #666;
                border-top: 1px solid #ccc;
                padding-top: 5mm;
            }

            @page {
                @top-center {
                    content: element(header);
                }
                @bottom-center {
                    content: element(footer);
                }
            }
        }

        .action-button.scroll-nav {
            padding: 10px;
            width: 48px;
            height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .company-count-card {
            max-width: 180px;
            padding: 10px;
            margin-left: 0;
            text-align: center;
        }

        .company-count-card {
            max-width: 45mm !important;
            padding: 2mm !important;
            margin-bottom: 2mm !important;
            margin-left: 0 !important;
            margin-right: auto !important;
            text-align: center !important;
        }

        .logo-circle {
            position: absolute;
            top: -30px;
            right: 30px;
            width: 100px;
            height: 100px;
            background: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
            border: 3px solid rgba(255, 255, 255, 0.8);
            z-index: 10;
        }

        .logo-circle img {
            width: 60px;
            height: 60px;
        }

      .header-gradient .flex.items-center {
    align-items: center;
}

        .action-button.fleet {
            background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
            box-shadow: 0 4px 15px rgba(245, 158, 11, 0.4);
        }

        .action-button.fleet:hover {
            box-shadow: 0 8px 25px rgba(245, 158, 11, 0.6);
        }
    </style>
</head>
<body>
    <div class="max-w-7xl mx-auto dashboard-container">
        <!-- Header com Logo -->
<div class="header-gradient p-8">
    <div class="logo-circle">
        <img src="https://api.platform-production.ensun.io/file/external-company-logo/67aa3fb5fe46411a0b728dd1" alt="Logo">
    </div>
    <div class="flex items-center gap-6">
        <div class="logo-container">
            <i class="fas fa-chart-pie text-white text-2xl"></i>
        </div>
        <div>
            <h1 class="text-3xl font-bold text-white">Dashboard de Vendas Rede Dom Pedro</h1>
            <p class="text-white/80 mt-2">Análise de Formas de Pagamento</p>
        </div>
        <div class="flex items-center gap-4 no-print">
            <button id="printButton" class="action-button" onclick="window.print()">
                <i class="fas fa-print"></i>
                Imprimir
            </button>
            <button id="exportCSV" class="action-button secondary">
                <i class="fas fa-download"></i>
                Exportar CSV
            </button>
            <button id="clearData" class="action-button danger">
                <i class="fas fa-trash"></i>
                Limpar
            </button>
        </div>
    </div>
</div>
        <!-- Botões de navegação -->
        <div class="fixed right-4 top-1/2 transform -translate-y-1/2 flex flex-col gap-2 no-print">
            <button id="scrollToTop" class="action-button" title="Vai para o Topo">
                <i class="fas fa-arrow-up"></i>
            </button>
            <button id="scrollToBottom" class="action-button" title="Vai para o Fim">
                <i class="fas fa-arrow-down"></i>
            </button>
        </div>

        <!-- Upload de Arquivos e Campo de Litros -->
        <div class="p-4 no-print">
            <div class="flex flex-col gap-4">
                <div class="file-input" id="fileInputArea">
                    <input type="file" id="fileInput" multiple accept=".pdf">
                    <div class="text-center">
                        <i class="fas fa-cloud-upload-alt text-2xl icon-gradient mb-2"></i>
                        <p class="text-base font-semibold text-gray-700">Arraste ou clique para selecionar PDFs</p>
                        <p class="text-xs text-gray-500 mt-1">Suporta múltiplos arquivos</p>
                    </div>
                </div>
                <div>
                    <label for="litersInput" class="text-sm font-medium text-gray-600">Total de Litros Vendidos no Mês</label>
                    <input type="number" id="litersInput" class="liters-input" placeholder="Digite a quantidade em litros" step="0.01" min="0">
                </div>
            </div>
            <div id="loadingSpinner" class="loading-spinner" style="display: none;"></div>
            <div id="successMessage" class="success-message" style="display: none;"></div>
        </div>

        <!-- Cards de Estatísticas -->
        <div class="px-8 pb-8 no-print" id="statsContainer">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6" id="statsCards"></div>
        </div>

        <!-- Gráfico -->
        <div class="px-8 pb-8">
            <div class="chart-container chart-3d">
                <canvas id="salesChart" class="w-full h-96"></canvas>
                <div class="print-values" id="printValues"></div>
            </div>
        </div>

        <!-- Filtros e Busca -->
        <div class="px-8 pb-4 no-print">
            <div class="flex flex-col gap-4">
                <input type="text" id="searchInput" class="search-input" placeholder="Buscar por empresa...">
                <div class="flex gap-2">
                    <button id="uncheckAll" class="action-button secondary" onclick="uncheckAllCheckboxes()">
                        Desmarcar Todos
                    </button>
                    <button id="sortAsc" class="action-button secondary">
                        <i class="fas fa-sort-amount-up"></i>
                        % Crescente
                    </button>
                    <button id="sortDesc" class="action-button secondary">
                        <i class="fas fa-sort-amount-down"></i>
                        % Decrescente
                    </button>
                    <button id="selectCredit" class="action-button secondary" onclick="selectCreditCheckboxes()">
                        <i class="fas fa-credit-card"></i>
                        Selecionar Crédito
                    </button>
                    <button id="selectDebit" class="action-button secondary" onclick="selectDebitCheckboxes()">
                        <i class="fas fa-money-check-alt"></i>
                        Selecionar Débito
                    </button>
                    <button id="selectFleet" class="action-button fleet" onclick="selectFleetCheckboxes()">
                        <i class="fas fa-truck"></i>
                        Cartão Frotas
                    </button>
                </div>
                <div class="checkbox-grid">
                    <label class="checkbox-label">
                        <input type="checkbox" id="cashCheckbox" value="cash">
                        Dinheiro
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="creditNotesCheckbox" value="creditNotes">
                        Notas a Prazo
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="preDatedCheckbox" value="preDated">
                        Cheque Pré-Datado
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="onSightCheckbox" value="onSight">
                        Cheque À Vista
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefTicketCheckbox" value="tefTicket">
                        TEF - Ticket Log
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="redeFrotaCheckbox" value="redeFrota">
                        Rede Frota Crédito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefMasterCheckbox" value="tefMaster">
                        TEF - Mastercard
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="pixStoneCheckbox" value="pixStone">
                        PIX (Stone)
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="proFrotasCheckbox" value="proFrotas">
                        Pro Frotas
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefVisaCheckbox" value="tefVisa">
                        TEF - Visa Electron
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefMasterMaestrCheckbox" value="tefMasterMaestr">
                        TEF - Master Maestr
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="ctfCheckbox" value="ctf">
                        CTF
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefTruckPagCheckbox" value="tefTruckPag">
                        TEF - Truck Pag
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefVisaCrediCheckbox" value="tefVisaCredi">
                        TEF - Visa Credi
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="qrLinxPixCheckbox" value="qrLinxPix">
                        QR Linx - PIX
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefAleloAutoCheckbox" value="tefAleloAuto">
                        TEF - Alelo Auto
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefCtfTefCheckbox" value="tefCtfTef">
                        TEF - CTF TEF
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="truckPagAbasteCheckbox" value="truckPagAbaste">
                        Truck Pag Abaste
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefValeCardCheckbox" value="tefValeCard">
                        TEF - Vale Card
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefEloDebitoCheckbox" value="tefEloDebito">
                        TEF - Elo Débito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefEloCreditCheckbox" value="tefEloCredit">
                        TEF - Elo Crédito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="visaDebitoCheckbox" value="visaDebito">
                        Visa Débito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="targetPayCheckbox" value="targetPay">
                        Target Pay
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="cartaFreteCheckbox" value="cartaFrete">
                        Carta Frete
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="visaCreditoCheckbox" value="visaCredito">
                        Visa Crédito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="masterCardCredCheckbox" value="masterCardCred">
                        MasterCard Crédito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefVisaElectronLioCheckbox" value="tefVisaElectronLio">
                        TEF - Visa Electron Lio
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="redeSempreCheckbox" value="redeSempre">
                        Rede Sempre
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="repomAbasteciCheckbox" value="repomAbasteci">
                        Repom Abasteci
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefMaxiFrotaCheckbox" value="tefMaxiFrota">
                        TEF - Maxi Frota
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefSodexoWizCheckbox" value="tefSodexoWiz">
                        TEF - Sodexo Wiz
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="novoAbasteceAiCheckbox" value="novoAbasteceAi">
                        Novo Abastece AI
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="masterCardDebiCheckbox" value="masterCardDebi">
                        MasterCard Débito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefSouthAmerCheckbox" value="tefSouthAmer">
                        TEF - South Amer
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="eFreteCheckbox" value="eFrete">
                        E-Frete
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefAmericanECheckbox" value="tefAmericanE">
                        TEF - American E
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="ticketLogCheckbox" value="ticketLog">
                        Ticket Log
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="fleetcardCreditoCheckbox" value="fleetcardCredito">
                        Fleetcard Crédito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefFitcardCrCheckbox" value="tefFitcardCr">
                        TEF - Fitcard Cr
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="southAmericaCheckbox" value="southAmerica">
                        South America
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefSenffCardCheckbox" value="tefSenffCard">
                        TEF - Senff Card
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="eloDebitoCheckbox" value="eloDebito">
                        Elo Débito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="eloCreditoCheckbox" value="eloCredito">
                        Elo Crédito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="pamcardFrotaCheckbox" value="pamcardFrota">
                        Pamcard Frota +
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="x7BankCheckbox" value="x7Bank">
                        X7 Bank
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefFlexFrotaCheckbox" value="tefFlexFrota">
                        TEF - Flex Frota
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="aleloAutoCrediCheckbox" value="aleloAutoCredi">
                        Alelo Auto Credi
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="fitcardCreditoCheckbox" value="fitcardCredito">
                        Fitcard Crédito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="repomSaqueCheckbox" value="repomSaque">
                        Repom Saque
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="redeFrotaDebitoCheckbox" value="redeFrotaDebito">
                        Rede Frota Débito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefPolicardCheckbox" value="tefPolicard">
                        TEF - Policard
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefVrBeneficCheckbox" value="tefVrBenefic">
                        TEF - VR Benefic
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="bamexCheckbox" value="bamex">
                        Bamex
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="vrBeneficiosCheckbox" value="vrBeneficios">
                        VR Benefícios
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="motivoTefCheckbox" value="motivoTef">
                        Motivo TEF
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="saqjaStoneNovoCheckbox" value="saqjaStoneNovo">
                        Saqja Stone Novo
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefBrasilCarCheckbox" value="tefBrasilCar">
                        TEF - Brasil Car
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefCabalCredCheckbox" value="tefCabalCred">
                        TEF - Cabal Crédito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefCabalDebiCheckbox" value="tefCabalDebi">
                        TEF - Cabal Débito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefPersonalCCheckbox" value="tefPersonalC">
                        TEF - Personal C
                    </label>
                </div>
            </div>
        </div>

        <!-- Contador de empresas -->
        <div class="px-4 pb-2">
            <div class="stat-card company-count-card">
                <div class="flex items-center justify-center gap-2">
                    <div>
                        <p class="text-xs font-medium text-gray-600">Número de Empresas</p>
                        <p class="text-lg font-bold text-gray-900" id="companyCount">0</p>
                    </div>
                    <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                        <i class="fas fa-building text-blue-600 text-base"></i>
                    </div>
                </div>
            </div>
        </div>

        <!-- Tabela -->
        <div class="px-4 pb-8 w-full">
            <div class="table-container">
                <table class="modern-table w-full">
                    <thead id="tableHeader"></thead>
                    <tbody id="tableBody"></tbody>
                    <tfoot id="tableFooter" class="bg-gray-50 font-semibold"></tfoot>
                </table>
            </div>
        </div>

        <div class="print-header">
            Relatório de Vendas por Forma de Pagamento
        </div>
        <div class="print-footer">
            Gerado em: <span id="printDate"></span> 
        </div>
    </div>

    <script>
        // Configuração do PDF.js
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.12.313/pdf.worker.min.js';
        
        // Variáveis globais
        let salesData = [];
        let filteredData = [];
        let chartInstance = null;
        let sortOrder = null;
        let totalLiters = 0;
        let pricePerLiter = 0;

        // Elementos DOM
        const fileInput = document.getElementById('fileInput');
        const fileInputArea = document.getElementById('fileInputArea');
        const tableHeader = document.getElementById('tableHeader');
        const tableBody = document.getElementById('tableBody');
        const tableFooter = document.getElementById('tableFooter');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const successMessage = document.getElementById('successMessage');
        const printValues = document.getElementById('printValues');
        const statsCards = document.getElementById('statsCards');
        const searchInput = document.getElementById('searchInput');
        const sortAscButton = document.getElementById('sortAsc');
        const sortDescButton = document.getElementById('sortDesc');
        const printDate = document.getElementById('printDate');
        const litersInput = document.getElementById('litersInput');

        // Mapeamento de colunas e ícones
        const paymentTypes = {
            cash: { label: 'Dinheiro', icon: 'fa-money-bill' },
            creditNotes: { label: 'Notas a Prazo', icon: 'fa-file-invoice' },
            preDated: { label: 'Cheque Pré-Datado', icon: 'fa-calendar-alt' },
            onSight: { label: 'Cheque À Vista', icon: 'fa-eye' },
            tefTicket: { label: 'TEF - Ticket Log', icon: 'fa-credit-card' },
            redeFrota: { label: 'Rede Frota Crédito', icon: 'fa-credit-card' },
            tefMaster: { label: 'TEF - Mastercard', icon: 'fa-credit-card' },
            pixStone: { label: 'PIX (Stone)', icon: 'fa-qrcode' },
            proFrotas: { label: 'Pro Frotas', icon: 'fa-truck' },
            tefVisa: { label: 'TEF - Visa Electron', icon: 'fa-credit-card' },
            tefMasterMaestr: { label: 'TEF - Master Maestr', icon: 'fa-credit-card' },
            ctf: { label: 'CTF', icon: 'fa-credit-card' },
            tefTruckPag: { label: 'TEF - Truck Pag', icon: 'fa-credit-card' },
            tefVisaCredi: { label: 'TEF - Visa Credi', icon: 'fa-credit-card' },
            qrLinxPix: { label: 'QR Linx - PIX', icon: 'fa-qrcode' },
            tefAleloAuto: { label: 'TEF - Alelo Auto', icon: 'fa-credit-card' },
            tefCtfTef: { label: 'TEF - CTF TEF', icon: 'fa-credit-card' },
            truckPagAbaste: { label: 'Truck Pag Abaste', icon: 'fa-credit-card' },
            tefValeCard: { label: 'TEF - Vale Card', icon: 'fa-credit-card' },
            tefEloDebito: { label: 'TEF - Elo Débito', icon: 'fa-credit-card' },
            tefEloCredit: { label: 'TEF - Elo Crédito', icon: 'fa-credit-card' },
            visaDebito: { label: 'Visa Débito', icon: 'fa-credit-card' },
            targetPay: { label: 'Target Pay', icon: 'fa-credit-card' },
            cartaFrete: { label: 'Carta Frete', icon: 'fa-file-invoice' },
            visaCredito: { label: 'Visa Crédito', icon: 'fa-credit-card' },
            masterCardCred: { label: 'MasterCard Crédito', icon: 'fa-credit-card' },
            tefVisaElectronLio: { label: 'TEF - Visa Electron Lio', icon: 'fa-credit-card' },
            redeSempre: { label: 'Rede Sempre', icon: 'fa-credit-card' },
            repomAbasteci: { label: 'Repom Abasteci', icon: 'fa-gas-pump' },
            tefMaxiFrota: { label: 'TEF - Maxi Frota', icon: 'fa-truck' },
            tefSodexoWiz: { label: 'TEF - Sodexo Wiz', icon: 'fa-credit-card' },
            novoAbasteceAi: { label: 'Novo Abastece AI', icon: 'fa-gas-pump' },
            masterCardDebi: { label: 'MasterCard Débito', icon: 'fa-credit-card' },
            tefSouthAmer: { label: 'TEF - South Amer', icon: 'fa-credit-card' },
            eFrete: { label: 'E-Frete', icon: 'fa-truck' },
            tefAmericanE: { label: 'TEF - American E', icon: 'fa-credit-card' },
            ticketLog: { label: 'Ticket Log', icon: 'fa-credit-card' },
            fleetcardCredito: { label: 'Fleetcard Crédito', icon: 'fa-credit-card' },
            tefFitcardCr: { label: 'TEF - Fitcard Cr', icon: 'fa-credit-card' },
            southAmerica: { label: 'South America', icon: 'fa-credit-card' },
            tefSenffCard: { label: 'TEF - Senff Card', icon: 'fa-credit-card' },
            eloDebito: { label: 'Elo Débito', icon: 'fa-credit-card' },
            eloCredito: { label: 'Elo Crédito', icon: 'fa-credit-card' },
            pamcardFrota: { label: 'Pamcard Frota +', icon: 'fa-credit-card' },
            x7Bank: { label: 'X7 Bank', icon: 'fa-credit-card' },
            tefFlexFrota: { label: 'TEF - Flex Frota', icon: 'fa-credit-card' },
            aleloAutoCredi: { label: 'Alelo Auto Credi', icon: 'fa-credit-card' },
            fitcardCredito: { label: 'Fitcard Crédito', icon: 'fa-credit-card' },
            repomSaque: { label: 'Repom Saque', icon: 'fa-money-bill-wave' },
            redeFrotaDebito: { label: 'Rede Frota Débito', icon: 'fa-credit-card' },
            tefPolicard: { label: 'TEF - Policard', icon: 'fa-credit-card' },
            tefVrBenefic: { label: 'TEF - VR Benefic', icon: 'fa-credit-card' },
            bamex: { label: 'Bamex', icon: 'fa-credit-card' },
            vrBeneficios: { label: 'VR Benefícios', icon: 'fa-credit-card' },
            motivoTef: { label: 'Motivo TEF', icon: 'fa-credit-card' },
            saqjaStoneNovo: { label: 'Saqja Stone Novo', icon: 'fa-credit-card' },
            tefBrasilCar: { label: 'TEF - Brasil Car', icon: 'fa-credit-card' },
            tefCabalCred: { label: 'TEF - Cabal Crédito', icon: 'fa-credit-card' },
            tefCabalDebi: { label: 'TEF - Cabal Débito', icon: 'fa-credit-card' },
            tefPersonalC: { label: 'TEF - Personal C', icon: 'fa-credit-card' }
        };

        // Obter todos os checkboxes
        const checkboxes = Array.from(document.querySelectorAll('.checkbox-label input[type="checkbox"]'));

        // Mapeamento de colunas para checkboxes
        const columnMap = {};
        checkboxes.forEach(checkbox => {
            const value = checkbox.value;
            columnMap[value] = [
                `${value}-column`,
                `${value}-percent-column`,
                `${value}-liters-column`
            ];
        });

        // Event listeners
        fileInput.addEventListener('change', handleFiles);
        document.getElementById('exportCSV').addEventListener('click', exportToCSV);
        document.getElementById('clearData').addEventListener('click', clearAllData);
        searchInput.addEventListener('input', handleSearch);
        sortAscButton.addEventListener('click', () => sortData('asc'));
        sortDescButton.addEventListener('click', () => sortData('desc'));
        litersInput.addEventListener('input', updatePricePerLiter);
        checkboxes.forEach(checkbox => checkbox.addEventListener('change', updateDisplay));

        // Drag and drop functionality
        fileInputArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            fileInputArea.style.borderColor = '#667eea';
        });

        fileInputArea.addEventListener('dragleave', (e) => {
            e.preventDefault();
            fileInputArea.style.borderColor = '#cbd5e1';
        });

        fileInputArea.addEventListener('drop', (e) => {
            e.preventDefault();
            fileInputArea.style.borderColor = '#cbd5e1';
            const files = e.dataTransfer.files;
            handleFiles({ target: { files } });
        });

        fileInputArea.addEventListener('click', () => {
            fileInput.click();
        });

        // Função para formatar valores monetários
        function formatarValor(valor) {
            if (isNaN(valor)) return '0,00';
            return valor.toFixed(2)
                .replace('.', ',')
                .replace(/\B(?=(\d{3})+(?!\d))/g, '.');
        }

        // Função para formatar valores em litros
        function formatarLitros(valor) {
            if (isNaN(valor)) return '0,00';
            return valor.toFixed(2)
                .replace('.', ',')
                .replace(/\B(?=(\d{3})+(?!\d))/g, '.');
        }

        // Carregar dados salvos ao inicializar
        window.addEventListener('load', loadSavedData);

        function loadSavedData() {
            const savedData = localStorage.getItem('salesReportData');
            const savedLiters = localStorage.getItem('totalLiters');
            if (savedData) {
                salesData = JSON.parse(savedData);
                filteredData = [...salesData];
                setDefaultCheckboxes();
                updateDisplay();
            }
            if (savedLiters) {
                totalLiters = parseFloat(savedLiters);
                litersInput.value = totalLiters;
                updatePricePerLiter();
            }
        }

        function saveData() {
            localStorage.setItem('salesReportData', JSON.stringify(salesData));
            localStorage.setItem('totalLiters', totalLiters.toString());
        }

        function setDefaultCheckboxes() {
            checkboxes.forEach(checkbox => {
                checkbox.checked = checkbox.value === 'cash' || checkbox.value === 'creditNotes';
            });
        }

        function updatePricePerLiter() {
            totalLiters = parseFloat(litersInput.value) || 0;
            const grandTotal = filteredData.reduce((sum, data) => sum + data.total, 0);
            pricePerLiter = grandTotal && totalLiters ? grandTotal / totalLiters : 0;
            saveData();
            updateDisplay();
        }

        async function handleFiles(event) {
            const files = Array.from(event.target.files);
            if (files.length === 0) return;

            loadingSpinner.style.display = 'block';

            for (const file of files) {
                try {
                    const fileName = file.name.replace('.pdf', '').replace(/_/g, ' ').trim();
                    const fileData = await extractDataFromPDF(file);

                    const existingIndex = salesData.findIndex(item => item.fileName === fileName);

                    const newData = {
                        fileName,
                        cash: fileData.dinheiro,
                        cashPercent: fileData.percentDinheiro,
                        cashLiters: 0,
                        creditNotes: fileData.notasAPrazo,
                        creditNotesPercent: fileData.percentNotasAPrazo,
                        creditNotesLiters: 0,
                        preDated: fileData.chequePreDatado,
                        preDatedPercent: fileData.percentChequePreDatado,
                        preDatedLiters: 0,
                        onSight: fileData.chequeAVista,
                        onSightPercent: fileData.percentChequeAVista,
                        onSightLiters: 0,
                        tefTicket: fileData.tefTicketLog || 0,
                        tefTicketPercent: fileData.percentTefTicketLog || 0,
                        tefTicketLiters: 0,
                        redeFrota: fileData.redeFrotaCredito || 0,
                        redeFrotaPercent: fileData.percentRedeFrotaCredito || 0,
                        redeFrotaLiters: 0,
                        tefMaster: fileData.tefMastercard || 0,
                        tefMasterPercent: fileData.percentTefMastercard || 0,
                        tefMasterLiters: 0,
                        pixStone: fileData.pixStone || 0,
                        pixStonePercent: fileData.percentPixStone || 0,
                        pixStoneLiters: 0,
                        proFrotas: fileData.proFrotas || 0,
                        proFrotasPercent: fileData.percentProFrotas || 0,
                        proFrotasLiters: 0,
                        tefVisa: fileData.tefVisaElectron || 0,
                        tefVisaPercent: fileData.percentTefVisaElectron || 0,
                        tefVisaLiters: 0,
                        tefMasterMaestr: fileData.tefMasterMaestr || 0,
                        tefMasterMaestrPercent: fileData.percentTefMasterMaestr || 0,
                        tefMasterMaestrLiters: 0,
                        ctf: fileData.ctf || 0,
                        ctfPercent: fileData.percentCtf || 0,
                        ctfLiters: 0,
                        tefTruckPag: fileData.tefTruckPag || 0,
                        tefTruckPagPercent: fileData.percentTefTruckPag || 0,
                        tefTruckPagLiters: 0,
                        tefVisaCredi: fileData.tefVisaCredi || 0,
                        tefVisaCrediPercent: fileData.percentTefVisaCredi || 0,
                        tefVisaCrediLiters: 0,
                        qrLinxPix: fileData.qrLinxPix || 0,
                        qrLinxPixPercent: fileData.percentQrLinxPix || 0,
                        qrLinxPixLiters: 0,
                        tefAleloAuto: fileData.tefAleloAuto || 0,
                        tefAleloAutoPercent: fileData.percentTefAleloAuto || 0,
                        tefAleloAutoLiters: 0,
                        tefCtfTef: fileData.tefCtfTef || 0,
                        tefCtfTefPercent: fileData.percentTefCtfTef || 0,
                        tefCtfTefLiters: 0,
                        truckPagAbaste: fileData.truckPagAbaste || 0,
                        truckPagAbastePercent: fileData.percentTruckPagAbaste || 0,
                        truckPagAbasteLiters: 0,
                        tefValeCard: fileData.tefValeCard || 0,
                        tefValeCardPercent: fileData.percentTefValeCard || 0,
                        tefValeCardLiters: 0,
                        tefEloDebito: fileData.tefEloDebito || 0,
                        tefEloDebitoPercent: fileData.percentTefEloDebito || 0,
                        tefEloDebitoLiters: 0,
                        tefEloCredit: fileData.tefEloCredit || 0,
                        tefEloCreditPercent: fileData.percentTefEloCredit || 0,
                        tefEloCreditLiters: 0,
                        visaDebito: fileData.visaDebito || 0,
                        visaDebitoPercent: fileData.percentVisaDebito || 0,
                        visaDebitoLiters: 0,
                        targetPay: fileData.targetPay || 0,
                        targetPayPercent: fileData.percentTargetPay || 0,
                        targetPayLiters: 0,
                        cartaFrete: fileData.cartaFrete || 0,
                        cartaFretePercent: fileData.percentCartaFrete || 0,
                        cartaFreteLiters: 0,
                        visaCredito: fileData.visaCredito || 0,
                        visaCreditoPercent: fileData.percentVisaCredito || 0,
                        visaCreditoLiters: 0,
                        masterCardCred: fileData.masterCardCred || 0,
                        masterCardCredPercent: fileData.percentMasterCardCred || 0,
                        masterCardCredLiters: 0,
                        tefVisaElectronLio: fileData.tefVisaElectronLio || 0,
                        tefVisaElectronLioPercent: fileData.percentTefVisaElectronLio || 0,
                        tefVisaElectronLioLiters: 0,
                        redeSempre: fileData.redeSempre || 0,
                        redeSemprePercent: fileData.percentRedeSempre || 0,
                        redeSempreLiters: 0,
                        repomAbasteci: fileData.repomAbasteci || 0,
                        repomAbasteciPercent: fileData.percentRepomAbasteci || 0,
                        repomAbasteciLiters: 0,
                        tefMaxiFrota: fileData.tefMaxiFrota || 0,
                        tefMaxiFrotaPercent: fileData.percentTefMaxiFrota || 0,
                        tefMaxiFrotaLiters: 0,
                        tefSodexoWiz: fileData.tefSodexoWiz || 0,
                        tefSodexoWizPercent: fileData.percentTefSodexoWiz || 0,
                        tefSodexoWizLiters: 0,
                        novoAbasteceAi: fileData.novoAbasteceAi || 0,
                        novoAbasteceAiPercent: fileData.percentNovoAbasteceAi || 0,
                        novoAbasteceAiLiters: 0,
                        masterCardDebi: fileData.masterCardDebi || 0,
                        masterCardDebiPercent: fileData.percentMasterCardDebi || 0,
                        masterCardDebiLiters: 0,
                        tefSouthAmer: fileData.tefSouthAmer || 0,
                        tefSouthAmerPercent: fileData.percentTefSouthAmer || 0,
                        tefSouthAmerLiters: 0,
                        eFrete: fileData.eFrete || 0,
                        eFretePercent: fileData.percentEFrete || 0,
                        eFreteLiters: 0,
                        tefAmericanE: fileData.tefAmericanE || 0,
                        tefAmericanEPercent: fileData.percentTefAmericanE || 0,
                        tefAmericanELiters: 0,
                        ticketLog: fileData.ticketLog || 0,
                        ticketLogPercent: fileData.percentTicketLog || 0,
                        ticketLogLiters: 0,
                        fleetcardCredito: fileData.fleetcardCredito || 0,
                        fleetcardCreditoPercent: fileData.percentFleetcardCredito || 0,
                        fleetcardCreditoLiters: 0,
                        tefFitcardCr: fileData.tefFitcardCr || 0,
                        tefFitcardCrPercent: fileData.percentTefFitcardCr || 0,
                        tefFitcardCrLiters: 0,
                        southAmerica: fileData.southAmerica || 0,
                        southAmericaPercent: fileData.percentSouthAmerica || 0,
                        southAmericaLiters: 0,
                        tefSenffCard: fileData.tefSenffCard || 0,
                        tefSenffCardPercent: fileData.percentTefSenffCard || 0,
                        tefSenffCardLiters: 0,
                        eloDebito: fileData.eloDebito || 0,
                        eloDebitoPercent: fileData.percentEloDebito || 0,
                        eloDebitoLiters: 0,
                        eloCredito: fileData.eloCredito || 0,
                        eloCreditoPercent: fileData.percentEloCredito || 0,
                        eloCreditoLiters: 0,
                        pamcardFrota: fileData.pamcardFrota || 0,
                        pamcardFrotaPercent: fileData.percentPamcardFrota || 0,
                        pamcardFrotaLiters: 0,
                        x7Bank: fileData.x7Bank || 0,
                        x7BankPercent: fileData.percentX7Bank || 0,
                        x7BankLiters: 0,
                        tefFlexFrota: fileData.tefFlexFrota || 0,
                        tefFlexFrotaPercent: fileData.percentTefFlexFrota || 0,
                        tefFlexFrotaLiters: 0,
                        aleloAutoCredi: fileData.aleloAutoCredi || 0,
                        aleloAutoCrediPercent: fileData.percentAleloAutoCredi || 0,
                        aleloAutoCrediLiters: 0,
                        fitcardCredito: fileData.fitcardCredito || 0,
                        fitcardCreditoPercent: fileData.percentFitcardCredito || 0,
                        fitcardCreditoLiters: 0,
                        repomSaque: fileData.repomSaque || 0,
                        repomSaquePercent: fileData.percentRepomSaque || 0,
                        repomSaqueLiters: 0,
                        redeFrotaDebito: fileData.redeFrotaDebito || 0,
                        redeFrotaDebitoPercent: fileData.percentRedeFrotaDebito || 0,
                        redeFrotaDebitoLiters: 0,
                        tefPolicard: fileData.tefPolicard || 0,
                        tefPolicardPercent: fileData.percentTefPolicard || 0,
                        tefPolicardLiters: 0,
                        tefVrBenefic: fileData.tefVrBenefic || 0,
                        tefVrBeneficPercent: fileData.percentTefVrBenefic || 0,
                        tefVrBeneficLiters: 0,
                        bamex: fileData.bamex || 0,
                        bamexPercent: fileData.percentBamex || 0,
                        bamexLiters: 0,
                        vrBeneficios: fileData.vrBeneficios || 0,
                        vrBeneficiosPercent: fileData.percentVrBeneficios || 0,
                        vrBeneficiosLiters: 0,
                        motivoTef: fileData.motivoTef || 0,
                        motivoTefPercent: fileData.percentMotivoTef || 0,
                        motivoTefLiters: 0,
                        saqjaStoneNovo: fileData.saqjaStoneNovo || 0,
                        saqjaStoneNovoPercent: fileData.percentSaqjaStoneNovo || 0,
                        saqjaStoneNovoLiters: 0,
                        tefBrasilCar: fileData.tefBrasilCar || 0,
                        tefBrasilCarPercent: fileData.percentTefBrasilCar || 0,
                        tefBrasilCarLiters: 0,
                        tefCabalCred: fileData.tefCabalCred || 0,
                        tefCabalCredPercent: fileData.percentTefCabalCred || 0,
                        tefCabalCredLiters: 0,
                        tefCabalDebi: fileData.tefCabalDebi || 0,
                        tefCabalDebiPercent: fileData.percentTefCabalDebi || 0,
                        tefCabalDebiLiters: 0,
                        tefPersonalC: fileData.tefPersonalC || 0,
                        tefPersonalCPercent: fileData.percentTefPersonalC || 0,
                        tefPersonalCLiters: 0,
                        total: fileData.totalVendas,
                        totalLiters: 0,
                        timestamp: new Date().toISOString()
                    };

                    if (existingIndex >= 0) {
                        salesData[existingIndex] = newData;
                    } else {
                        salesData.push(newData);
                    }
                } catch (error) {
                    console.error(`Erro ao processar o arquivo ${file.name}:`, error);
                }
            }

            filteredData = [...salesData];
            updatePricePerLiter();
            loadingSpinner.style.display = 'none';
            setDefaultCheckboxes();
            saveData();
            updateDisplay();
            showSuccessMessage(`${files.length} arquivo(s) processado(s) com sucesso!`);
        }

        function showSuccessMessage(message) {
            successMessage.innerHTML = `
                <div class="success-message">
                    <i class="fas fa-check-circle"></i>
                    ${message}
                </div>
            `;
            successMessage.style.display = 'block';
            setTimeout(() => {
                successMessage.style.display = 'none';
            }, 3000);
        }

        function handleSearch() {
            const searchTerm = searchInput.value.toLowerCase();
            filteredData = salesData.filter(data => 
                data.fileName.toLowerCase().includes(searchTerm)
            );
            if (sortOrder) {
                sortData(sortOrder);
            } else {
                updateDisplay();
            }
        }

        function sortData(order) {
            sortOrder = order;
            filteredData.sort((a, b) => {
                if (order === 'asc') {
                    return a.onSightPercent - b.onSightPercent;
                } else {
                    return b.onSightPercent - a.onSightPercent;
                }
            });
            updateDisplay();
        }

        function updateDisplay() {
            document.getElementById('companyCount').textContent = filteredData.length;
            updateDataLiters();
            updateColumnVisibility();
            updateTable();
            updateStats();
            updateChart();
            updatePrintDate();
        }

        function updateDataLiters() {
            filteredData.forEach(data => {
                Object.keys(paymentTypes).forEach(type => {
                    data[`${type}Liters`] = pricePerLiter ? data[type] / pricePerLiter : 0;
                });
                data.totalLiters = pricePerLiter ? data.total / pricePerLiter : 0;
            });
        }

        function updatePrintDate() {
            const now = new Date();
            printDate.textContent = now.toLocaleString('pt-BR');
        }

        function updateColumnVisibility() {
            document.querySelectorAll('th, td').forEach(el => {
                el.classList.remove('hidden-column');
            });

            checkboxes.forEach(checkbox => {
                const value = checkbox.value;
                if (!checkbox.checked && columnMap[value]) {
                    columnMap[value].forEach(colClass => {
                        document.querySelectorAll(`.${colClass}`).forEach(el => {
                            el.classList.add('hidden-column');
                        });
                    });
                }
            });
        }

        function calculateSelectedIndex() {
    const selectedTypes = checkboxes.filter(checkbox => checkbox.checked).map(checkbox => checkbox.value);
    const grandTotal = filteredData.reduce((sum, data) => sum + data.total, 0);
    const grandTotalLiters = filteredData.reduce((sum, data) => sum + data.totalLiters, 0);

    // Calcular o total selecionado e os litros selecionados
    const totalSelected = filteredData.reduce((sum, data) => {
        return sum + selectedTypes.reduce((typeSum, type) => typeSum + (data[type] || 0), 0);
    }, 0);

    const totalSelectedLiters = filteredData.reduce((sum, data) => {
        return sum + selectedTypes.reduce((typeSum, type) => typeSum + (data[`${type}Liters`] || 0), 0);
    }, 0);

    // Calcular a porcentagem
    const percentage = grandTotal ? (totalSelected / grandTotal * 100) : 0;

    // Verificar se todas as formas de pagamento estão selecionadas
    const allSelected = selectedTypes.length === Object.keys(paymentTypes).length;

    // Se todas as formas de pagamento estão selecionadas, garantir que os valores sejam iguais
    return {
        totalSelected: allSelected ? grandTotal : totalSelected,
        totalSelectedLiters: allSelected ? grandTotalLiters : totalSelectedLiters,
        percentage: allSelected ? 100 : percentage
    };
}

     function updateStats() {
    statsCards.innerHTML = '';
    const selectedTypes = checkboxes.filter(checkbox => checkbox.checked).map(checkbox => checkbox.value);
    const grandTotal = filteredData.reduce((sum, data) => sum + data.total, 0);
    const grandTotalLiters = totalLiters || filteredData.reduce((sum, data) => sum + data.totalLiters, 0);

    // Card de Total de Vendas
    const totalCard = document.createElement('div');
    totalCard.className = 'stat-card';
    totalCard.innerHTML = `
        <div class="flex items-center justify-between">
            <div>
                <p class="text-sm font-medium text-gray-600">Total de Vendas</p>
                <p class="text-2xl font-bold text-gray-900">${formatarValor(grandTotal)}</p>
                <p class="text-xs text-gray-500">${formatarLitros(grandTotalLiters)} L</p>
            </div>
            <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center">
                <i class="fas fa-dollar-sign text-blue-600 text-xl"></i>
            </div>
        </div>
    `;
    statsCards.appendChild(totalCard);

    // Card de Índice dos Selecionados
    if (selectedTypes.length > 0) {
        const selectedIndex = calculateSelectedIndex();
        const indexCard = document.createElement('div');
        indexCard.className = 'stat-card';
        indexCard.innerHTML = `
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-gray-600">Índice dos Selecionados</p>
                    <p class="text-2xl font-bold text-gray-900">${selectedIndex.percentage.toFixed(2)}%</p>
                    <p class="text-xs text-gray-500">${formatarValor(selectedIndex.totalSelected)} de ${formatarValor(grandTotal)}</p>
                    <p class="text-xs text-gray-500">${formatarLitros(selectedIndex.totalSelectedLiters)} L</p>
                </div>
                <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center">
                    <i class="fas fa-percentage text-green-600 text-xl"></i>
                </div>
            </div>
        `;
        statsCards.appendChild(indexCard);

        // Card de Litros dos Selecionados
        const litersCard = document.createElement('div');
        litersCard.className = 'stat-card';
        litersCard.innerHTML = `
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-gray-600">Litros dos Selecionados</p>
                    <p class="text-2xl font-bold text-gray-900">${formatarLitros(selectedIndex.totalSelectedLiters)}</p>
                    <p class="text-xs text-gray-500">${selectedIndex.percentage.toFixed(2)}% de ${formatarLitros(grandTotalLiters)} L</p>
                </div>
                <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center">
                    <i class="fas fa-tint text-green-600 text-xl"></i>
                </div>
            </div>
        `;
        statsCards.appendChild(litersCard);
    }

    // Cards individuais para cada tipo de pagamento selecionado
    selectedTypes.forEach(type => {
        const total = filteredData.reduce((sum, data) => sum + data[type], 0);
        const totalLiters = filteredData.reduce((sum, data) => sum + data[`${type}Liters`], 0);
        const card = document.createElement('div');
        card.className = 'stat-card';
        card.innerHTML = `
            <div class="flex items-center justify-between">
                <div>
                    <p class="text-sm font-medium text-gray-600">${paymentTypes[type].label}</p>
                    <p class="text-2xl font-bold text-gray-900">${formatarValor(total)}</p>
                    <p class="text-xs text-gray-500">${formatarLitros(totalLiters)} L</p>
                </div>
                <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center">
                    <i class="fas ${paymentTypes[type].icon} text-blue-600 text-xl"></i>
                </div>
            </div>
        `;
        statsCards.appendChild(card);
    });
}

        function updateTable() {
            tableHeader.innerHTML = '';
            tableBody.innerHTML = '';
            tableFooter.innerHTML = '';

            const selectedTypes = checkboxes.filter(checkbox => checkbox.checked).map(checkbox => checkbox.value);

            // Create table header
            let headerHtml = '<tr><th><i class="fas fa-building mr-2"></i>Empresa</th>';
            selectedTypes.forEach(type => {
                headerHtml += `
                    <th class="text-right ${type}-column"><i class="fas ${paymentTypes[type].icon} mr-2"></i>${paymentTypes[type].label}</th>
                    <th class="text-right ${type}-percent-column"><i class="fas fa-percentage mr-2"></i>% ${paymentTypes[type].label}</th>
                    <th class="text-right ${type}-liters-column"><i class="fas fa-tint mr-2"></i>L ${paymentTypes[type].label}</th>
                `;
            });
            headerHtml += '<th class="text-right"><i class="fas fa-dollar-sign mr-2"></i>Total de Vendas</th>';
            headerHtml += '<th class="text-right"><i class="fas fa-tint mr-2"></i>Total Litros</th></tr>';
            tableHeader.innerHTML = headerHtml;

            // Create table body
            filteredData.forEach(data => {
                const row = document.createElement('tr');
                let rowHtml = `<td class="font-medium">${data.fileName}</td>`;
                selectedTypes.forEach(type => {
                    rowHtml += `
                        <td class="text-right ${type}-column">${formatarValor(data[type])}</td>
                        <td class="text-right ${type}-percent-column">${data[`${type}Percent`]?.toFixed(2)}%</td>
                        <td class="text-right ${type}-liters-column">${formatarLitros(data[`${type}Liters`])}</td>
                    `;
                });
                rowHtml += `<td class="text-right font-semibold">${formatarValor(data.total)}</td>`;
                rowHtml += `<td class="text-right font-semibold">${formatarLitros(data.totalLiters)}</td>`;
                row.innerHTML = rowHtml;
                tableBody.appendChild(row);
            });

            // Create table footer
            if (filteredData.length > 0) {
                const totals = {};
                const percents = {};
                const liters = {};
                selectedTypes.forEach(type => {
                    totals[type] = filteredData.reduce((sum, data) => sum + data[type], 0);
                    percents[type] = filteredData.reduce((sum, data) => sum + (data[`${type}Percent`] || 0), 0);
                    liters[type] = filteredData.reduce((sum, data) => sum + (data[`${type}Liters`] || 0), 0);
                });
                const grandTotal = filteredData.reduce((sum, data) => sum + data.total, 0);
                const grandTotalLiters = filteredData.reduce((sum, data) => sum + data.totalLiters, 0);

                const footerRow = document.createElement('tr');
                let footerHtml = '<td class="font-bold text-gray-900">TOTAL GERAL</td>';
                selectedTypes.forEach(type => {
                    footerHtml += `
                        <td class="text-right font-bold text-gray-900 ${type}-column">${formatarValor(totals[type])}</td>
                        <td class="text-right font-bold text-gray-900 ${type}-percent-column">${((totals[type] / grandTotal) * 100).toFixed(2)}%</td>
                        <td class="text-right font-bold text-gray-900 ${type}-liters-column">${formatarLitros(liters[type])}</td>
                    `;
                });
                footerHtml += `<td class="text-right font-bold text-gray-900">${formatarValor(grandTotal)}</td>`;
                footerHtml += `<td class="text-right font-bold text-gray-900">${formatarLitros(grandTotalLiters)}</td>`;
                footerRow.innerHTML = footerHtml;
                tableFooter.appendChild(footerRow);
            }

            updateColumnVisibility();
        }

        function updateChart() {
            if (typeof Chart === 'undefined') {
                console.error('Chart.js não foi carregado.');
                printValues.innerHTML = '<p>Erro: Chart.js não carregado.</p>';
                return;
            }

            const ctx = document.getElementById('salesChart')?.getContext('2d');
            if (!ctx) {
                console.error('Canvas com ID "salesChart" não encontrado.');
                printValues.innerHTML = '<p>Erro: Elemento de canvas não encontrado.</p>';
                return;
            }

            if (chartInstance) {
                chartInstance.destroy();
            }

            if (!filteredData || filteredData.length === 0) {
                console.warn('Nenhum dado disponível em filteredData.');
                printValues.innerHTML = '<p>Nenhum dado disponível.</p>';
                return;
            }

            const selectedTypes = checkboxes
                .filter(checkbox => checkbox.checked)
                .map(checkbox => checkbox.value);
            const datasets = [];

            const colors = [
                '#eab308', '#8b5cf6', '#ef4444', '#10b981', '#3b82f6', '#f97316', '#06b6d4',
                '#8b5cf6', '#ec4899', '#14b8a6', '#f59e0b', '#84cc16', '#0ea5e9', '#a855f7',
                '#d946ef', '#f43f5e', '#22d3ee', '#f472b6', '#fb923c', '#4ade80', '#38bdf8',
                '#c084fc', '#e879f9', '#fb7185', '#2dd4bf', '#fbbf24', '#34d399', '#60a5fa',
                '#a78bfa', '#f87171', '#818cf8', '#f472b6', '#fb923c', '#4ade80', '#38bdf8',
                '#c084fc', '#e879f9', '#fb7185', '#2dd4bf', '#fbbf24', '#34d399', '#60a5fa',
                '#a78bfa', '#f87171', '#818cf8', '#f472b6', '#fb923c', '#4ade80', '#38bdf8'
            ];

            selectedTypes.forEach((type, index) => {
                if (filteredData[0][type] !== undefined) {
                    datasets.push({
                        label: paymentTypes[type].label,
                        data: filteredData.map(data => data[`${type}Liters`]),
                        borderColor: colors[index % colors.length],
                        backgroundColor: `${colors[index % colors.length]}20`,
                        borderWidth: 2,
                        tension: 0.3,
                        fill: false,
                        pointBackgroundColor: colors[index % colors.length],
                        pointRadius: 4,
                        pointHoverRadius: 7
                    });
                }
            });

            const totals = {};
            const liters = {};
            selectedTypes.forEach(type => {
                totals[type] = filteredData.reduce((sum, data) => sum + (data[type] || 0), 0);
                liters[type] = filteredData.reduce((sum, data) => sum + (data[`${type}Liters`] || 0), 0);
            });
            
            const grandTotal = filteredData.reduce((sum, data) => sum + data.total, 0);
            const grandTotalLiters = filteredData.reduce((sum, data) => sum + data.totalLiters, 0);

            // Create chart
            chartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: filteredData.map(data => data.fileName),
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                font: {
                                    size: 12,
                                    family: "'Inter', sans-serif"
                                },
                                padding: 20,
                                boxWidth: 12,
                                usePointStyle: true
                            }
                        },
                        tooltip: {
                            mode: 'index',
                            intersect: false,
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleFont: { family: "'Inter', sans-serif", size: 14 },
                            bodyFont: { family: "'Inter', sans-serif", size: 12 },
                            padding: 12,
                            callbacks: {
                                label: function(context) {
                                    const value = context.parsed.y || 0;
                                    return `${context.dataset.label}: ${formatarLitros(value)} L`;
                                }
                            }
                        }
                    },
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Empresas',
                                font: { family: "'Inter', sans-serif", size: 14, weight: '600' },
                                color: '#374151'
                            },
                            ticks: {
                                font: { family: "'Inter', sans-serif", size: 12 },
                                maxRotation: 45,
                                minRotation: 45
                            },
                            grid: {
                                display: false
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Litros Vendidos',
                                font: { family: "'Inter', sans-serif", size: 14, weight: '600' },
                                color: '#374151'
                            },
                            ticks: {
                                font: { family: "'Inter', sans-serif", size: 12 },
                                callback: function(value) {
                                    return formatarLitros(value);
                                }
                            },
                            grid: {
                                color: '#e2e8f0'
                            },
                            beginAtZero: true
                        }
                    },
                    interaction: {
                        mode: 'index',
                        intersect: false
                    }
                }
            });

            // Update print values
            let printHtml = '<ul>';
            selectedTypes.forEach(type => {
                printHtml += `
                    <li>
                        <strong>${paymentTypes[type].label}:</strong> 
                        ${formatarValor(totals[type])} (${((totals[type] / grandTotal) * 100).toFixed(2)}%) 
                        - ${formatarLitros(liters[type])} L
                    </li>
                `;
            });
            printHtml += `
                <li><strong>Total Geral:</strong> ${formatarValor(grandTotal)} - ${formatarLitros(grandTotalLiters)} L</li>
            `;
            printHtml += '</ul>';
            printValues.innerHTML = printHtml;
        }

        function exportToCSV() {
            if (!filteredData.length) {
                showSuccessMessage('Nenhum dado para exportar!');
                return;
            }

            const selectedTypes = checkboxes.filter(checkbox => checkbox.checked).map(checkbox => checkbox.value);
            const headers = ['Empresa'];
            selectedTypes.forEach(type => {
                headers.push(paymentTypes[type].label, `% ${paymentTypes[type].label}`, `Litros ${paymentTypes[type].label}`);
            });
            headers.push('Total de Vendas', 'Total Litros');

            const rows = filteredData.map(data => {
                const row = [data.fileName];
                selectedTypes.forEach(type => {
                    row.push(formatarValor(data[type]), data[`${type}Percent`]?.toFixed(2), formatarLitros(data[`${type}Liters`]));
                });
                row.push(formatarValor(data.total), formatarLitros(data.totalLiters));
                return row;
            });

            const totals = {};
            const percents = {};
            const liters = {};
            selectedTypes.forEach(type => {
                totals[type] = filteredData.reduce((sum, data) => sum + data[type], 0);
                percents[type] = filteredData.reduce((sum, data) => sum + (data[`${type}Percent`] || 0), 0);
                liters[type] = filteredData.reduce((sum, data) => sum + (data[`${type}Liters`] || 0), 0);
            });
            const grandTotal = filteredData.reduce((sum, data) => sum + data.total, 0);
            const grandTotalLiters = filteredData.reduce((sum, data) => sum + data.totalLiters, 0);

            const footer = ['TOTAL GERAL'];
            selectedTypes.forEach(type => {
                footer.push(formatarValor(totals[type]), ((totals[type] / grandTotal) * 100).toFixed(2), formatarLitros(liters[type]));
            });
            footer.push(formatarValor(grandTotal), formatarLitros(grandTotalLiters));

            const csvContent = [
                headers.join(','),
                ...rows.map(row => row.join(',')),
                footer.join(',')
            ].join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `relatorio_vendas_${new Date().toISOString().split('T')[0]}.csv`;
            link.click();
            URL.revokeObjectURL(link.href);
        }

        function clearAllData() {
            salesData = [];
            filteredData = [];
            totalLiters = 0;
            pricePerLiter = 0;
            litersInput.value = '';
            localStorage.removeItem('salesReportData');
            localStorage.removeItem('totalLiters');
            setDefaultCheckboxes();
            updateDisplay();
            showSuccessMessage('Dados limpos com sucesso!');
        }

        function uncheckAllCheckboxes() {
            checkboxes.forEach(checkbox => checkbox.checked = false);
            updateDisplay();
        }

        function selectCreditCheckboxes() {
            const creditTypes = ['tefMaster', 'tefVisaCredi', 'tefEloCredit', 'visaCredito', 'masterCardCred', 'tefVisaElectronLio', 'fleetcardCredito', 'tefFitcardCr', 'eloCredito', 'fitcardCredito', 'aleloAutoCredi', 'tefCabalCred'];
            checkboxes.forEach(checkbox => {
                checkbox.checked = creditTypes.includes(checkbox.value);
            });
            updateDisplay();
        }

        function selectDebitCheckboxes() {
            const debitTypes = ['tefVisa', 'tefMasterMaestr', 'tefEloDebito', 'visaDebito', 'masterCardDebi', 'eloDebito', 'redeFrotaDebito', 'tefCabalDebi'];
            checkboxes.forEach(checkbox => {
                checkbox.checked = debitTypes.includes(checkbox.value);
            });
            updateDisplay();
        }

        function selectFleetCheckboxes() {
            const fleetTypes = ['tefTicket', 'redeFrota', 'proFrotas', 'tefTruckPag', 'tefAleloAuto', 'tefCtfTef', 'truckPagAbaste', 'tefValeCard', 'repomAbasteci', 'tefMaxiFrota', 'tefSodexoWiz', 'novoAbasteceAi', 'eFrete', 'ticketLog', 'pamcardFrota', 'tefFlexFrota', 'tefPolicard'];
            checkboxes.forEach(checkbox => {
                checkbox.checked = fleetTypes.includes(checkbox.value);
            });
            updateDisplay();
        }

        // Scroll navigation
        document.getElementById('scrollToTop').addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        document.getElementById('scrollToBottom').addEventListener('click', () => {
            window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
        });

        // Função simulada para extrair dados de PDF
        async function extractDataFromPDF(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = async function(e) {
                    try {
                        const typedarray = new Uint8Array(e.target.result);
                        const pdf = await pdfjsLib.getDocument(typedarray).promise;
                        let text = '';

                        for (let i = 1; i <= pdf.numPages; i++) {
                            const page = await pdf.getPage(i);
                            const content = await page.getTextContent();
                            text += content.items.map(item => item.str).join(' ') + ' ';
                        }

                        const data = {
                            dinheiro: parseFloat(text.match(/Dinheiro\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentDinheiro: parseFloat(text.match(/% Dinheiro\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            notasAPrazo: parseFloat(text.match(/Notas a Prazo\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentNotasAPrazo: parseFloat(text.match(/% Notas a Prazo\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            chequePreDatado: parseFloat(text.match(/Cheque Pré-Datado\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentChequePreDatado: parseFloat(text.match(/% Cheque Pré-Datado\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            chequeAVista: parseFloat(text.match(/Cheque À Vista\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentChequeAVista: parseFloat(text.match(/% Cheque À Vista\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            totalVendas: parseFloat(text.match(/Total de Vendas\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            tefTicketLog: parseFloat(text.match(/TEF - Ticket Log\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTefTicketLog: parseFloat(text.match(/% TEF - Ticket Log\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            redeFrotaCredito: parseFloat(text.match(/Rede Frota Crédito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentRedeFrotaCredito: parseFloat(text.match(/% Rede Frota Crédito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            tefMastercard: parseFloat(text.match(/TEF - Mastercard\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTefMastercard: parseFloat(text.match(/% TEF - Mastercard\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            pixStone: parseFloat(text.match(/PIX \(Stone\)\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentPixStone: parseFloat(text.match(/% PIX \(Stone\)\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            proFrotas: parseFloat(text.match(/Pro Frotas\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentProFrotas: parseFloat(text.match(/% Pro Frotas\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            tefVisaElectron: parseFloat(text.match(/TEF - Visa Electron\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTefVisaElectron: parseFloat(text.match(/% TEF - Visa Electron\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            tefMasterMaestr: parseFloat(text.match(/TEF - Master Maestr\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTefMasterMaestr: parseFloat(text.match(/% TEF - Master Maestr\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            ctf: parseFloat(text.match(/CTF\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentCtf: parseFloat(text.match(/% CTF\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            tefTruckPag: parseFloat(text.match(/TEF - Truck Pag\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTefTruckPag: parseFloat(text.match(/% TEF - Truck Pag\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            tefVisaCredi: parseFloat(text.match(/TEF - Visa Credi\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTefVisaCredi: parseFloat(text.match(/% TEF - Visa Credi\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            qrLinxPix: parseFloat(text.match(/QR Linx - PIX\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentQrLinxPix: parseFloat(text.match(/% QR Linx - PIX\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            tefAleloAuto: parseFloat(text.match(/TEF - Alelo Auto\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTefAleloAuto: parseFloat(text.match(/% TEF - Alelo Auto\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            tefCtfTef: parseFloat(text.match(/TEF - CTF TEF\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTefCtfTef: parseFloat(text.match(/% TEF - CTF TEF\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            truckPagAbaste: parseFloat(text.match(/Truck Pag Abaste\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTruckPagAbaste: parseFloat(text.match(/% Truck Pag Abaste\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            tefValeCard: parseFloat(text.match(/TEF - Vale Card\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTefValeCard: parseFloat(text.match(/% TEF - Vale Card\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            tefEloDebito: parseFloat(text.match(/TEF - Elo Débito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTefEloDebito: parseFloat(text.match(/% TEF - Elo Débito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            tefEloCredit: parseFloat(text.match(/TEF - Elo Crédito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTefEloCredit: parseFloat(text.match(/% TEF - Elo Crédito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            visaDebito: parseFloat(text.match(/Visa Débito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentVisaDebito: parseFloat(text.match(/% Visa Débito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            targetPay: parseFloat(text.match(/Target Pay\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTargetPay: parseFloat(text.match(/% Target Pay\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            cartaFrete: parseFloat(text.match(/Carta Frete\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentCartaFrete: parseFloat(text.match(/% Carta Frete\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            visaCredito: parseFloat(text.match(/Visa Crédito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentVisaCredito: parseFloat(text.match(/% Visa Crédito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            masterCardCred: parseFloat(text.match(/MasterCard Crédito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentMasterCardCred: parseFloat(text.match(/% MasterCard Crédito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            tefVisaElectronLio: parseFloat(text.match(/TEF - Visa Electron Lio\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTefVisaElectronLio: parseFloat(text.match(/% TEF - Visa Electron Lio\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            redeSempre: parseFloat(text.match(/Rede Sempre\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentRedeSempre: parseFloat(text.match(/% Rede Sempre\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            repomAbasteci: parseFloat(text.match(/Repom Abasteci\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentRepomAbasteci: parseFloat(text.match(/% Repom Abasteci\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            tefMaxiFrota: parseFloat(text.match(/TEF - Maxi Frota\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTefMaxiFrota: parseFloat(text.match(/% TEF - Maxi Frota\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            tefSodexoWiz: parseFloat(text.match(/TEF - Sodexo Wiz\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTefSodexoWiz: parseFloat(text.match(/% TEF - Sodexo Wiz\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            novoAbasteceAi: parseFloat(text.match(/Novo Abastece AI\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentNovoAbasteceAi: parseFloat(text.match(/% Novo Abastece AI\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            masterCardDebi: parseFloat(text.match(/MasterCard Débito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentMasterCardDebi: parseFloat(text.match(/% MasterCard Débito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            tefSouthAmer: parseFloat(text.match(/TEF - South Amer\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTefSouthAmer: parseFloat(text.match(/% TEF - South Amer\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            eFrete: parseFloat(text.match(/E-Frete\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentEFrete: parseFloat(text.match(/% E-Frete\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            tefAmericanE: parseFloat(text.match(/TEF - American E\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTefAmericanE: parseFloat(text.match(/% TEF - American E\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            ticketLog: parseFloat(text.match(/Ticket Log\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTicketLog: parseFloat(text.match(/% Ticket Log\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            fleetcardCredito: parseFloat(text.match(/Fleetcard Crédito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentFleetcardCredito: parseFloat(text.match(/% Fleetcard Crédito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            tefFitcardCr: parseFloat(text.match(/TEF - Fitcard Cr\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTefFitcardCr: parseFloat(text.match(/% TEF - Fitcard Cr\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            southAmerica: parseFloat(text.match(/South America\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentSouthAmerica: parseFloat(text.match(/% South America\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            tefSenffCard: parseFloat(text.match(/TEF - Senff Card\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTefSenffCard: parseFloat(text.match(/% TEF - Senff Card\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            eloDebito: parseFloat(text.match(/Elo Débito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentEloDebito: parseFloat(text.match(/% Elo Débito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            eloCredito: parseFloat(text.match(/Elo Crédito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentEloCredito: parseFloat(text.match(/% Elo Crédito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            pamcardFrota: parseFloat(text.match(/Pamcard Frota \+\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentPamcardFrota: parseFloat(text.match(/% Pamcard Frota \+\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            x7Bank: parseFloat(text.match(/X7 Bank\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentX7Bank: parseFloat(text.match(/% X7 Bank\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            tefFlexFrota: parseFloat(text.match(/TEF - Flex Frota\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTefFlexFrota: parseFloat(text.match(/% TEF - Flex Frota\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            aleloAutoCredi: parseFloat(text.match(/Alelo Auto Credi\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentAleloAutoCredi: parseFloat(text.match(/% Alelo Auto Credi\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            fitcardCredito: parseFloat(text.match(/Fitcard Crédito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentFitcardCredito: parseFloat(text.match(/% Fitcard Crédito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            repomSaque: parseFloat(text.match(/Repom Saque\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentRepomSaque: parseFloat(text.match(/% Repom Saque\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            redeFrotaDebito: parseFloat(text.match(/Rede Frota Débito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentRedeFrotaDebito: parseFloat(text.match(/% Rede Frota Débito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            tefPolicard: parseFloat(text.match(/TEF - Policard\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTefPolicard: parseFloat(text.match(/% TEF - Policard\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            tefVrBenefic: parseFloat(text.match(/TEF - VR Benefic\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTefVrBenefic: parseFloat(text.match(/% TEF - VR Benefic\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            bamex: parseFloat(text.match(/Bamex\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentBamex: parseFloat(text.match(/% Bamex\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            vrBeneficios: parseFloat(text.match(/VR Benefícios\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentVrBeneficios: parseFloat(text.match(/% VR Benefícios\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            motivoTef: parseFloat(text.match(/Motivo TEF\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentMotivoTef: parseFloat(text.match(/% Motivo TEF\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            saqjaStoneNovo: parseFloat(text.match(/Saqja Stone Novo\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentSaqjaStoneNovo: parseFloat(text.match(/% Saqja Stone Novo\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            tefBrasilCar: parseFloat(text.match(/TEF - Brasil Car\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTefBrasilCar: parseFloat(text.match(/% TEF - Brasil Car\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            tefCabalCred: parseFloat(text.match(/TEF - Cabal Crédito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTefCabalCred: parseFloat(text.match(/% TEF - Cabal Crédito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            tefCabalDebi: parseFloat(text.match(/TEF - Cabal Débito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTefCabalDebi: parseFloat(text.match(/% TEF - Cabal Débito\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            tefPersonalC: parseFloat(text.match(/TEF - Personal C\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0,
                            percentTefPersonalC: parseFloat(text.match(/% TEF - Personal C\s*:\s*([\d,.]+)/)?.[1].replace(',', '.')) || 0
                        };

                        resolve(data);
                    } catch (error) {
                        reject(error);
                    }
                };
                reader.readAsArrayBuffer(file);
            });
        }
    </script>
</body>
</html>
</xaiArtifact>

