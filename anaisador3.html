<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Vendas por Forma de Pagamento Rede Dom Pedro </title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.12.313/pdf.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: 10px;
            font-family: 'Inter', sans-serif;
        }

        .dashboard-container {
            max-width: 99% !important;
            margin: 0 auto;
            padding: 8px;
        }

        .table-container {
            width: 100%;
            overflow-x: auto;
        }

        .modern-table {
            width: 100%;
            table-layout: auto;
        }

        .header-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 20px 20px 0 0;
        }

        .logo-container {
            width: 60px;
            height: 60px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 16px;
            display: flex;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .stat-card {
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 10px 25px -3px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.8);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 40px -3px rgba(0, 0, 0, 0.15);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #667eea, #764ba2);
            border-radius: 16px 16px 0 0;
        }

        .action-button {
              background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
              box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            border: none;
            border-radius: 12px;
            color: white;
            padding: 12px 24px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .action-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
        }

        .action-button.secondary {
          background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
box-shadow: 0 4px 15px rgba(139, 92, 246, 0.4);
        }

        .action-button.secondary:hover {
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.6);
        }

        .action-button.danger {
            background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);
            box-shadow: 0 4px 15px rgba(239, 68, 68, 0.4);
        }

        .action-button.danger:hover {
            box-shadow: 0 8px 25px rgba(239, 68, 68, 0.6);
        }

        .file-input {
            position: relative;
            overflow: hidden;
            display: inline-block;
            cursor: pointer;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border: 2px dashed #cbd5e1;
            border-radius: 16px;
            padding: 32px;
            text-align: center;
            transition: all 0.3s ease;
            width: 100%;
        }

        .file-input:hover {
            border-color: #667eea;
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
        }

        .file-input input[type=file] {
            position: absolute;
            left: -9999px;
        }

        .table-container {
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 25px -3px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.8);
            overflow: hidden;
        }

        .modern-table {
            width: 100%;
            border-collapse: collapse;
        }

        .modern-table th {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 16px;
            text-align: left;
            font-weight: 600;
            font-size: 14px;
            letter-spacing: 0.5px;
        }

        .modern-table td {
            padding: 16px;
            border-bottom: 1px solid #f1f5f9;
            transition: all 0.3s ease;
            text-align: left !important; /* Mantém a coluna "Empresa" alinhada à esquerda */
        }

        .modern-table tr:hover td {
            background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
        }

        .chart-container {
            background: white;
            border-radius: 16px;
            box-shadow: 0 10px 25px -3px rgba(0, 0, 0, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.8);
            position: relative;
        }

        .chart-3d {
            background: radial-gradient(circle at 50% 50%, #f8fafc 0%, #e2e8f0 100%);
            border-radius: 16px;
            padding: 24px;
        }

        .pulse-animation {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .icon-gradient {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .glassmorphism {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 16px;
        }

        .checkbox-grid {
            display: grid;
            grid-template-columns: repeat(12, 1fr);
            gap: 16px;
            margin-bottom: 16px;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 14px;
            color: #374151;
            cursor: pointer;
        }

        .checkbox-label input[type="checkbox"] {
            appearance: none;
            width: 20px;
            height: 20px;
            border: 2px solid #cbd5e1;
            border-radius: 4px;
            transition: all 0.3s ease;
        }

        .checkbox-label input[type="checkbox"]:checked {
            border-color: #667eea;
            background-color: #667eea;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 16 16' fill='white' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M12.207 4.793a1 1 0 010 1.414l-5 5a1 1 0 01-1.414 0l-2-2a1 1 0 011.414-1.414L6.5 9.086l4.293-4.293a1 1 0 011.414 0z'/%3E%3C/svg%3E");
        }

        .checkbox-label input[type="checkbox"]:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .search-input {
            background: white;
            border: 1px solid #cbd5e1;
            border-radius: 12px;
            padding: 12px;
            width: 100%;
            max-width: 300px;
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .loading-spinner {
            border: 4px solid #f3f4f6;
            border-top: 4px solid #667eea;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 20px auto;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .success-message {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            color: white;
            padding: 12px 24px;
            border-radius: 12px;
            margin: 16px 0;
            display: flex;
            align-items: center;
            gap: 8px;
            animation: slideIn 0.3s ease;
        }

        .print-values {
            display: none;
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(-20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .hidden-column {
            display: none;
        }

    @media print {
   @page {
    size: landscape; /* Orientação horizontal */
    margin: 0; /* Remove margens padrão */
}

    body {
        background: white;
        padding: 0;
        margin: 0;
        font-size: 10pt;
    }

    .no-print {
        display: none !important;
    }

    .dashboard-container {
        max-width: 100% !important;
        padding: 0 !important;
    }

    .header-gradient {
        border-radius: 0;
        padding: 10mm !important;
        position: relative;
        margin-bottom: 10mm;
    }

    .chart-container {
        page-break-inside: avoid; /* Evita que o gráfico seja dividido entre páginas */
        display: flex !important;
        flex-direction: row;
        align-items: center;
        justify-content: space-between;
        padding: 10mm !important;
        box-shadow: none;
        border: none;
    }

    #salesChart {
        width: 60% !important;
        height: auto !important;
    }

    .print-values {
        display: block !important;
        background: #f8fafc;
        border-radius: 8px;
        padding: 5mm !important; /* Reduz o padding para tornar a tabela mais compacta */
        margin-left: 5mm !important; /* Reduz a margem à esquerda */
        min-width: 80mm !important; /* Reduz a largura mínima para diminuir o tamanho */
    }

    .print-values ul {
        list-style: none;
        margin: 0;
        padding: 0;
    }

    .print-values li {
        margin-bottom: 6px !important; /* Reduz a margem inferior para maior compactação */
        font-size: 8pt !important; /* Reduz o tamanho da fonte para compactar */
        display: block; /* Remove o flex para alinhar à esquerda */
        text-align: left !important; /* Alinha o texto à esquerda */
    }

    .print-values strong {
        font-weight: 600;
    }

    .table-container {
        page-break-before: always; /* Força a tabela a começar em uma nova página */
        page-break-inside: avoid;
        box-shadow: none;
        border: none;
        margin-top: 10mm;
    }

    .modern-table {
        width: 100%;
        font-size: 8pt;
    }

    .modern-table th,
    .modern-table td {
        text-align: center !important; /* Centraliza o texto no cabeçalho e nas células */
        padding: 16px;
        border-bottom: 1px solid #f1f5f9;
        transition: all 0.3s ease;
    }

    .modern-table th:first-child,
    .modern-table td:first-child {
        text-align: left !important; /* Mantém a coluna "Empresa" alinhada à esquerda */
    }

    .print-header {
        position: running(header);
        text-align: center;
        font-size: 12pt;
        font-weight: bold;
        margin-bottom: 5mm;
    }

    .print-footer {
        position: running(footer);
        text-align: center;
        font-size: 8pt;
        color: #666;
        border-top: 1px solid #ccc;
        padding-top: 5mm;
    }

    @page {
        @top-center {
            content: element(header);
        }
        @bottom-center {
            content: element(footer);
        }
    }
}
/* Estilo para os botões de navegação */
.action-button.scroll-nav {
    padding: 10px;
    width: 48px;
    height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 18px;
}
/* Estilo para o cartão de número de empresas */
.company-count-card {
    max-width: 180px; /* Largura reduzida para um retângulo menor */
    padding: 10px; /* Padding reduzido para compactar */
    margin-left: 0; /* Alinha o cartão à esquerda na tela */
    text-align: center; /* Garante que o texto dentro do cartão seja centralizado */
}
/* Ajustar o contador de empresas na impressão */
.company-count-card {
    max-width: 45mm !important; /* Largura muito menor para a impressão */
    padding: 2mm !important; /* Padding reduzido na impressão */
    margin-bottom: 2mm !important; /* Menos espaço abaixo */
    margin-left: 0 !important; /* Centraliza o cartão horizontalmente */
    margin-right: auto !important; /* Centraliza o cartão horizontalmente */
    text-align: center !important; /* Garante que o texto dentro do cartão seja centralizado */
}
.logo-circle {
    position: absolute;
    top: -30px;
    right: 30px;
    width: 80px;
    height: 80px;
    background: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
    border: 3px solid rgba(255, 255, 255, 0.8);
    z-index: 10;
}

.logo-circle {
    width: 100px;  /* Aumente este valor */
    height:100px; /* Aumente este valor (mantenha igual ao width para permanecer circular) */
    top: -10px;    /* Ajuste proporcional para centralizar (metade do height) */
    right: 30px;
    /* ... restante do código ... */
}

.logo-circle img {
    width: 80px;   /* Aumente proporcionalmente */
    height: 80px;  /* Aumente proporcionalmente */
}

.header-gradient {
    position: relative; /* Adicione esta linha para permitir posicionamento absoluto do logo */
}
.action-button.fleet {
    background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%);
    box-shadow: 0 4px 15px rgba(245, 158, 11, 0.4);
}

.action-button.fleet:hover {
    box-shadow: 0 8px 25px rgba(245, 158, 11, 0.6);
}

    </style>
</head>
<body>
    
    <div class="max-w-7xl mx-auto dashboard-container">

        <!-- Header com Logo -->
     <div class="header-gradient p-8">
    <div class="logo-circle">
        <img src="data:image/jpeg;base64,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" alt="Logo">
    </div>
    <div class="flex items-center justify-between">
        <div class="flex items-center gap-6">
            <div class="logo-container">
                <i class="fas fa-chart-pie text-white text-2xl"></i>
            </div>
            <div>
                <h1 class="text-3xl font-bold text-white">Dashboard de Vendas Rede Dom Pedro</h1>
                <p class="text-white/80 mt-2">Análise de Formas de Pagamento</p>
            </div>
        </div>
                </div>
                <div class="flex items-center gap-4 no-print">
                    <button id="printButton" class="action-button" onclick="window.print()">
                        <i class="fas fa-print"></i>
                        Imprimir
                    </button>
                    <button id="exportCSV" class="action-button secondary">
                        <i class="fas fa-download"></i>
                        Exportar CSV
                    </button>
                    <button id="clearData" class="action-button danger">
                        <i class="fas fa-trash"></i>
                        Limpar
                    </button>
                </div>
            </div>
        </div>

<!-- Botões de navegação -->
<div class="fixed right-4 top-1/2 transform -translate-y-1/2 flex flex-col gap-2 no-print">
    <button id="scrollToTop" class="action-button" title="Vai para o Topo">
        <i class="fas fa-arrow-up"></i>
    </button>
    <button id="scrollToBottom" class="action-button" title="Vai para o Fim">
        <i class="fas fa-arrow-down"></i>
    </button>
</div>
       <!-- Upload de Arquivos -->
<div class="p-4 no-print">
    <div class="file-input" id="fileInputArea">
        <input type="file" id="fileInput" multiple accept=".pdf">
        <div class="text-center">
            <i class="fas fa-cloud-upload-alt text-2xl icon-gradient mb-2"></i>
            <p class="text-base font-semibold text-gray-700">Arraste ou clique para selecionar PDFs</p>
            <p class="text-xs text-gray-500 mt-1">Suporta múltiplos arquivos</p>
        </div>
    </div>
    <div id="loadingSpinner" class="loading-spinner" style="display: none;"></div>
    <div id="successMessage" class="success-message" style="display: none;"></div>
</div>

        <!-- Cards de Estatísticas -->
        <div class="px-8 pb-8 no-print" id="statsContainer">
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-6" id="statsCards"></div>
        </div>

        <!-- Gráfico -->
        <div class="px-8 pb-8">
            <div class="chart-container chart-3d">
                <canvas id="salesChart" class="w-full h-96"></canvas>
                <div class="print-values" id="printValues"></div>
            </div>
        </div>

        <!-- Filtros e Busca -->
        <div class="px-8 pb-4 no-print">
            <div class="flex flex-col gap-4">
                <input type="text" id="searchInput" class="search-input" placeholder="Buscar por empresa...">
                <div class="flex gap-2">
                    <button id="uncheckAll" class="action-button secondary" onclick="uncheckAllCheckboxes()">
                        Desmarcar Todos
                    </button>
                    <button id="sortAsc" class="action-button secondary">
                        <i class="fas fa-sort-amount-up"></i>
                        % Crescente
                    </button>
                    <button id="sortDesc" class="action-button secondary">
                        <i class="fas fa-sort-amount-down"></i>
                        % ÀDecrescente
                    </button>
<button id="selectCredit" class="action-button secondary" onclick="selectCreditCheckboxes()">
    <i class="fas fa-credit-card"></i>
    Selecionar Crédito
</button>

<button id="selectDebit" class="action-button secondary" onclick="selectDebitCheckboxes()">
    <i class="fas fa-money-check-alt"></i>
    Selecionar Débito
</button>
<button id="selectFleet" class="action-button fleet" onclick="selectFleetCheckboxes()">
    <i class="fas fa-truck"></i>
    Cartão Frotas
</button>

                </div>
                <div class="checkbox-grid">
                    <label class="checkbox-label">
                        <input type="checkbox" id="cashCheckbox" value="cash">
                        Dinheiro
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="creditNotesCheckbox" value="creditNotes">
                        Notas a Prazo
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="preDatedCheckbox" value="preDated">
                        Cheque Pré-Datado
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="onSightCheckbox" value="onSight">
                        Cheque À Vista
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefTicketCheckbox" value="tefTicket">
                        TEF - Ticket Log
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="redeFrotaCheckbox" value="redeFrota">
                        Rede Frota Crédito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefMasterCheckbox" value="tefMaster">
                        TEF - Mastercard
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="pixStoneCheckbox" value="pixStone">
                        PIX (Stone)
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="proFrotasCheckbox" value="proFrotas">
                        Pro Frotas
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefVisaCheckbox" value="tefVisa">
                        TEF - Visa Electron
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefMasterMaestrCheckbox" value="tefMasterMaestr">
                        TEF - Master Maestr
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="ctfCheckbox" value="ctf">
                        CTF
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefTruckPagCheckbox" value="tefTruckPag">
                        TEF - Truck Pag
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefVisaCrediCheckbox" value="tefVisaCredi">
                        TEF - Visa Credi
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="qrLinxPixCheckbox" value="qrLinxPix">
                        QR Linx - PIX
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefAleloAutoCheckbox" value="tefAleloAuto">
                        TEF - Alelo Auto
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefCtfTefCheckbox" value="tefCtfTef">
                        TEF - CTF TEF
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="truckPagAbasteCheckbox" value="truckPagAbaste">
                        Truck Pag Abaste
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefValeCardCheckbox" value="tefValeCard">
                        TEF - Vale Card
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefEloDebitoCheckbox" value="tefEloDebito">
                        TEF - Elo Débito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefEloCreditCheckbox" value="tefEloCredit">
                        TEF - Elo Crédito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="visaDebitoCheckbox" value="visaDebito">
                        Visa Débito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="targetPayCheckbox" value="targetPay">
                        Target Pay
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="cartaFreteCheckbox" value="cartaFrete">
                        Carta Frete
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="visaCreditoCheckbox" value="visaCredito">
                        Visa Crédito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="masterCardCredCheckbox" value="masterCardCred">
                        MasterCard Crédito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefVisaElectronLioCheckbox" value="tefVisaElectronLio">
                        TEF - Visa Electron Lio
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="redeSempreCheckbox" value="redeSempre">
                        Rede Sempre
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="repomAbasteciCheckbox" value="repomAbasteci">
                        Repom Abasteci
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefMaxiFrotaCheckbox" value="tefMaxiFrota">
                        TEF - Maxi Frota
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefSodexoWizCheckbox" value="tefSodexoWiz">
                        TEF - Sodexo Wiz
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="novoAbasteceAiCheckbox" value="novoAbasteceAi">
                        Novo Abastece AI
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="masterCardDebiCheckbox" value="masterCardDebi">
                        MasterCard Débito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefSouthAmerCheckbox" value="tefSouthAmer">
                        TEF - South Amer
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="eFreteCheckbox" value="eFrete">
                        E-Frete
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefAmericanECheckbox" value="tefAmericanE">
                        TEF - American E
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="ticketLogCheckbox" value="ticketLog">
                        Ticket Log
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="fleetcardCreditoCheckbox" value="fleetcardCredito">
                        Fleetcard Crédito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefFitcardCrCheckbox" value="tefFitcardCr">
                        TEF - Fitcard Cr
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="southAmericaCheckbox" value="southAmerica">
                        South America
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefSenffCardCheckbox" value="tefSenffCard">
                        TEF - Senff Card
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="eloDebitoCheckbox" value="eloDebito">
                        Elo Débito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="eloCreditoCheckbox" value="eloCredito">
                        Elo Crédito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="pamcardFrotaCheckbox" value="pamcardFrota">
                        Pamcard Frota +
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="x7BankCheckbox" value="x7Bank">
                        X7 Bank
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefFlexFrotaCheckbox" value="tefFlexFrota">
                        TEF - Flex Frota
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="aleloAutoCrediCheckbox" value="aleloAutoCredi">
                        Alelo Auto Credi
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="fitcardCreditoCheckbox" value="fitcardCredito">
                        Fitcard Crédito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="repomSaqueCheckbox" value="repomSaque">
                        Repom Saque
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="redeFrotaDebitoCheckbox" value="redeFrotaDebito">
                        Rede Frota Débito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefPolicardCheckbox" value="tefPolicard">
                        TEF - Policard
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefVrBeneficCheckbox" value="tefVrBenefic">
                        TEF - VR Benefic
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="bamexCheckbox" value="bamex">
                        Bamex
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="vrBeneficiosCheckbox" value="vrBeneficios">
                        VR Benefícios
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="motivoTefCheckbox" value="motivoTef">
                        Motivo TEF
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="saqjaStoneNovoCheckbox" value="saqjaStoneNovo">
                        Saqja Stone Novo
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefBrasilCarCheckbox" value="tefBrasilCar">
                        TEF - Brasil Car
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefCabalCredCheckbox" value="tefCabalCred">
                        TEF - Cabal Crédito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefCabalDebiCheckbox" value="tefCabalDebi">
                        TEF - Cabal Débito
                    </label>
                    <label class="checkbox-label">
                        <input type="checkbox" id="tefPersonalCCheckbox" value="tefPersonalC">
                        TEF - Personal C
                    </label>
                </div>
            </div>
        </div>
<!-- Contador de empresas -->
<div class="px-4 pb-2">
    <div class="stat-card company-count-card">
        <div class="flex items-center justify-center gap-2">
            <div>
                <p class="text-xs font-medium text-gray-600">Número de Empresas</p>
                <p class="text-lg font-bold text-gray-900" id="companyCount">0</p>
            </div>
            <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center">
                <i class="fas fa-building text-blue-600 text-base"></i>
            </div>
        </div>
    </div>
</div>
        <!-- Tabela -->
        <div class="px-4 pb-8 w-full">
            <div class="table-container">
                <table class="modern-table w-full">
                    <thead id="tableHeader"></thead>
                    <tbody id="tableBody"></tbody>
                    <tfoot id="tableFooter" class="bg-gray-50 font-semibold"></tfoot>
                </table>
            </div>
        </div>
    </div>
<div class="print-header">
        Relatório de Vendas por Forma de Pagamento
    </div>
    <div class="print-footer">
        Gerado em: <span id="printDate"></span> 
    </div>

    <script>
        // Configuração do PDF.js
        pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.12.313/pdf.worker.min.js';
        
        // Variáveis globais
        let salesData = [];
        let filteredData = [];
        let chartInstance = null;
        let sortOrder = null;

        // Elementos DOM
        const fileInput = document.getElementById('fileInput');
        const fileInputArea = document.getElementById('fileInputArea');
        const tableHeader = document.getElementById('tableHeader');
        const tableBody = document.getElementById('tableBody');
        const tableFooter = document.getElementById('tableFooter');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const successMessage = document.getElementById('successMessage');
        const printValues = document.getElementById('printValues');
        const statsCards = document.getElementById('statsCards');
        const searchInput = document.getElementById('searchInput');
        const sortAscButton = document.getElementById('sortAsc');
        const sortDescButton = document.getElementById('sortDesc');
        const printDate = document.getElementById('printDate');

        // Mapeamento de colunas e ícones
        const paymentTypes = {
            cash: { label: 'Dinheiro', icon: 'fa-money-bill' },
            creditNotes: { label: 'Notas a Prazo', icon: 'fa-file-invoice' },
            preDated: { label: 'Cheque Pré-Datado', icon: 'fa-calendar-alt' },
            onSight: { label: 'Cheque À Vista', icon: 'fa-eye' },
            tefTicket: { label: 'TEF - Ticket Log', icon: 'fa-credit-card' },
            redeFrota: { label: 'Rede Frota Crédito', icon: 'fa-credit-card' },
            tefMaster: { label: 'TEF - Mastercard', icon: 'fa-credit-card' },
            pixStone: { label: 'PIX (Stone)', icon: 'fa-qrcode' },
            proFrotas: { label: 'Pro Frotas', icon: 'fa-truck' },
            tefVisa: { label: 'TEF - Visa Electron', icon: 'fa-credit-card' },
            tefMasterMaestr: { label: 'TEF - Master Maestr', icon: 'fa-credit-card' },
            ctf: { label: 'CTF', icon: 'fa-credit-card' },
            tefTruckPag: { label: 'TEF - Truck Pag', icon: 'fa-credit-card' },
            tefVisaCredi: { label: 'TEF - Visa Credi', icon: 'fa-credit-card' },
            qrLinxPix: { label: 'QR Linx - PIX', icon: 'fa-qrcode' },
            tefAleloAuto: { label: 'TEF - Alelo Auto', icon: 'fa-credit-card' },
            tefCtfTef: { label: 'TEF - CTF TEF', icon: 'fa-credit-card' },
            truckPagAbaste: { label: 'Truck Pag Abaste', icon: 'fa-credit-card' },
            tefValeCard: { label: 'TEF - Vale Card', icon: 'fa-credit-card' },
            tefEloDebito: { label: 'TEF - Elo Débito', icon: 'fa-credit-card' },
            tefEloCredit: { label: 'TEF - Elo Crédito', icon: 'fa-credit-card' },
            visaDebito: { label: 'Visa Débito', icon: 'fa-credit-card' },
            targetPay: { label: 'Target Pay', icon: 'fa-credit-card' },
            cartaFrete: { label: 'Carta Frete', icon: 'fa-file-invoice' },
            visaCredito: { label: 'Visa Crédito', icon: 'fa-credit-card' },
            masterCardCred: { label: 'MasterCard Crédito', icon: 'fa-credit-card' },
            tefVisaElectronLio: { label: 'TEF - Visa Electron Lio', icon: 'fa-credit-card' },
            redeSempre: { label: 'Rede Sempre', icon: 'fa-credit-card' },
            repomAbasteci: { label: 'Repom Abasteci', icon: 'fa-gas-pump' },
            tefMaxiFrota: { label: 'TEF - Maxi Frota', icon: 'fa-truck' },
            tefSodexoWiz: { label: 'TEF - Sodexo Wiz', icon: 'fa-credit-card' },
            novoAbasteceAi: { label: 'Novo Abastece AI', icon: 'fa-gas-pump' },
            masterCardDebi: { label: 'MasterCard Débito', icon: 'fa-credit-card' },
            tefSouthAmer: { label: 'TEF - South Amer', icon: 'fa-credit-card' },
            eFrete: { label: 'E-Frete', icon: 'fa-truck' },
            tefAmericanE: { label: 'TEF - American E', icon: 'fa-credit-card' },
            ticketLog: { label: 'Ticket Log', icon: 'fa-credit-card' },
            fleetcardCredito: { label: 'Fleetcard Crédito', icon: 'fa-credit-card' },
            tefFitcardCr: { label: 'TEF - Fitcard Cr', icon: 'fa-credit-card' },
            southAmerica: { label: 'South America', icon: 'fa-credit-card' },
            tefSenffCard: { label: 'TEF - Senff Card', icon: 'fa-credit-card' },
            eloDebito: { label: 'Elo Débito', icon: 'fa-credit-card' },
            eloCredito: { label: 'Elo Crédito', icon: 'fa-credit-card' },
            pamcardFrota: { label: 'Pamcard Frota +', icon: 'fa-credit-card' },
            x7Bank: { label: 'X7 Bank', icon: 'fa-credit-card' },
            tefFlexFrota: { label: 'TEF - Flex Frota', icon: 'fa-credit-card' },
            aleloAutoCredi: { label: 'Alelo Auto Credi', icon: 'fa-credit-card' },
            fitcardCredito: { label: 'Fitcard Crédito', icon: 'fa-credit-card' },
            repomSaque: { label: 'Repom Saque', icon: 'fa-money-bill-wave' },
            redeFrotaDebito: { label: 'Rede Frota Débito', icon: 'fa-credit-card' },
            tefPolicard: { label: 'TEF - Policard', icon: 'fa-credit-card' },
            tefVrBenefic: { label: 'TEF - VR Benefic', icon: 'fa-credit-card' },
            bamex: { label: 'Bamex', icon: 'fa-credit-card' },
            vrBeneficios: { label: 'VR Benefícios', icon: 'fa-credit-card' },
            motivoTef: { label: 'Motivo TEF', icon: 'fa-credit-card' },
            saqjaStoneNovo: { label: 'Saqja Stone Novo', icon: 'fa-credit-card' },
            tefBrasilCar: { label: 'TEF - Brasil Car', icon: 'fa-credit-card' },
            tefCabalCred: { label: 'TEF - Cabal Crédito', icon: 'fa-credit-card' },
            tefCabalDebi: { label: 'TEF - Cabal Débito', icon: 'fa-credit-card' },
            tefPersonalC: { label: 'TEF - Personal C', icon: 'fa-credit-card' }
        };

        // Obter todos os checkboxes
        const checkboxes = Array.from(document.querySelectorAll('.checkbox-label input[type="checkbox"]'));

        // Mapeamento de colunas para checkboxes
        const columnMap = {};
        checkboxes.forEach(checkbox => {
            const value = checkbox.value;
            columnMap[value] = [
                `${value}-column`,
                `${value}-percent-column`
            ];
        });

        // Event listeners
        fileInput.addEventListener('change', handleFiles);
        document.getElementById('exportCSV').addEventListener('click', exportToCSV);
        document.getElementById('clearData').addEventListener('click', clearAllData);
        searchInput.addEventListener('input', handleSearch);
        sortAscButton.addEventListener('click', () => sortData('asc'));
        sortDescButton.addEventListener('click', () => sortData('desc'));
        checkboxes.forEach(checkbox => checkbox.addEventListener('change', updateDisplay));

        // Drag and drop functionality
        fileInputArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            fileInputArea.style.borderColor = '#667eea';
        });

        fileInputArea.addEventListener('dragleave', (e) => {
            e.preventDefault();
            fileInputArea.style.borderColor = '#cbd5e1';
        });

        fileInputArea.addEventListener('drop', (e) => {
            e.preventDefault();
            fileInputArea.style.borderColor = '#cbd5e1';
            const files = e.dataTransfer.files;
            handleFiles({ target: { files } });
        });

        fileInputArea.addEventListener('click', () => {
            fileInput.click();
        });

        // Função para formatar valores monetários
        function formatarValor(valor) {
            if (isNaN(valor)) return ' 0,00';
            return ' ' + valor.toFixed(2)
                .replace('.', ',')
                .replace(/\B(?=(\d{3})+(?!\d))/g, '.');
        }

        // Carregar dados salvos ao inicializar
        window.addEventListener('load', loadSavedData);

        function loadSavedData() {
            const savedData = localStorage.getItem('salesReportData');
            if (savedData) {
                salesData = JSON.parse(savedData);
                filteredData = [...salesData];
                setDefaultCheckboxes();
                updateDisplay();
            }
        }

        function saveData() {
            localStorage.setItem('salesReportData', JSON.stringify(salesData));
        }

        function setDefaultCheckboxes() {
            checkboxes.forEach(checkbox => {
                checkbox.checked = checkbox.value === 'cash' || checkbox.value === 'creditNotes';
            });
        }

        async function handleFiles(event) {
            const files = Array.from(event.target.files);
            if (files.length === 0) return;

            loadingSpinner.style.display = 'block';

            for (const file of files) {
                try {
                    const fileName = file.name.replace('.pdf', '').replace(/_/g, ' ').trim();
                    const fileData = await extractDataFromPDF(file);

                    const existingIndex = salesData.findIndex(item => item.fileName === fileName);

                    const newData = {
                        fileName,
                        cash: fileData.dinheiro,
                        cashPercent: fileData.percentDinheiro,
                        creditNotes: fileData.notasAPrazo,
                        creditNotesPercent: fileData.percentNotasAPrazo,
                        preDated: fileData.chequePreDatado,
                        preDatedPercent: fileData.percentChequePreDatado,
                        onSight: fileData.chequeAVista,
                        onSightPercent: fileData.percentChequeAVista,
                        tefTicket: fileData.tefTicketLog || 0,
                        tefTicketPercent: fileData.percentTefTicketLog || 0,
                        redeFrota: fileData.redeFrotaCredito || 0,
                        redeFrotaPercent: fileData.percentRedeFrotaCredito || 0,
                        tefMaster: fileData.tefMastercard || 0,
                        tefMasterPercent: fileData.percentTefMastercard || 0,
                        pixStone: fileData.pixStone || 0,
                        pixStonePercent: fileData.percentPixStone || 0,
                        proFrotas: fileData.proFrotas || 0,
                        proFrotasPercent: fileData.percentProFrotas || 0,
                        tefVisa: fileData.tefVisaElectron || 0,
                        tefVisaPercent: fileData.percentTefVisaElectron || 0,
                        tefMasterMaestr: fileData.tefMasterMaestr || 0,
                        tefMasterMaestrPercent: fileData.percentTefMasterMaestr || 0,
                        ctf: fileData.ctf || 0,
                        ctfPercent: fileData.percentCtf || 0,
                        tefTruckPag: fileData.tefTruckPag || 0,
                        tefTruckPagPercent: fileData.percentTefTruckPag || 0,
                        tefVisaCredi: fileData.tefVisaCredi || 0,
                        tefVisaCrediPercent: fileData.percentTefVisaCredi || 0,
                        qrLinxPix: fileData.qrLinxPix || 0,
                        qrLinxPixPercent: fileData.percentQrLinxPix || 0,
                        tefAleloAuto: fileData.tefAleloAuto || 0,
                        tefAleloAutoPercent: fileData.percentTefAleloAuto || 0,
                        tefCtfTef: fileData.tefCtfTef || 0,
                        tefCtfTefPercent: fileData.percentTefCtfTef || 0,
                        truckPagAbaste: fileData.truckPagAbaste || 0,
                        truckPagAbastePercent: fileData.percentTruckPagAbaste || 0,
                        tefValeCard: fileData.tefValeCard || 0,
                        tefValeCardPercent: fileData.percentTefValeCard || 0,
                        tefEloDebito: fileData.tefEloDebito || 0,
                        tefEloDebitoPercent: fileData.percentTefEloDebito || 0,
                        tefEloCredit: fileData.tefEloCredit || 0,
                        tefEloCreditPercent: fileData.percentTefEloCredit || 0,
                        visaDebito: fileData.visaDebito || 0,
                        visaDebitoPercent: fileData.percentVisaDebito || 0,
                        targetPay: fileData.targetPay || 0,
                        targetPayPercent: fileData.percentTargetPay || 0,
                        cartaFrete: fileData.cartaFrete || 0,
                        cartaFretePercent: fileData.percentCartaFrete || 0,
                        visaCredito: fileData.visaCredito || 0,
                        visaCreditoPercent: fileData.percentVisaCredito || 0,
                        masterCardCred: fileData.masterCardCred || 0,
                        masterCardCredPercent: fileData.percentMasterCardCred || 0,
                        tefVisaElectronLio: fileData.tefVisaElectronLio || 0,
                        tefVisaElectronLioPercent: fileData.percentTefVisaElectronLio || 0,
                        redeSempre: fileData.redeSempre || 0,
                        redeSemprePercent: fileData.percentRedeSempre || 0,
                        repomAbasteci: fileData.repomAbasteci || 0,
                        repomAbasteciPercent: fileData.percentRepomAbasteci || 0,
                        tefMaxiFrota: fileData.tefMaxiFrota || 0,
                        tefMaxiFrotaPercent: fileData.percentTefMaxiFrota || 0,
                        tefSodexoWiz: fileData.tefSodexoWiz || 0,
                        tefSodexoWizPercent: fileData.percentTefSodexoWiz || 0,
                        novoAbasteceAi: fileData.novoAbasteceAi || 0,
                        novoAbasteceAiPercent: fileData.percentNovoAbasteceAi || 0,
                        masterCardDebi: fileData.masterCardDebi || 0,
                        masterCardDebiPercent: fileData.percentMasterCardDebi || 0,
                        tefSouthAmer: fileData.tefSouthAmer || 0,
                        tefSouthAmerPercent: fileData.percentTefSouthAmer || 0,
                        eFrete: fileData.eFrete || 0,
                        eFretePercent: fileData.percentEFrete || 0,
                        tefAmericanE: fileData.tefAmericanE || 0,
                        tefAmericanEPercent: fileData.percentTefAmericanE || 0,
                        ticketLog: fileData.ticketLog || 0,
                        ticketLogPercent: fileData.percentTicketLog || 0,
                        fleetcardCredito: fileData.fleetcardCredito || 0,
                        fleetcardCreditoPercent: fileData.percentFleetcardCredito || 0,
                        tefFitcardCr: fileData.tefFitcardCr || 0,
                        tefFitcardCrPercent: fileData.percentTefFitcardCr || 0,
                        southAmerica: fileData.southAmerica || 0,
                        southAmericaPercent: fileData.percentSouthAmerica || 0,
                        tefSenffCard: fileData.tefSenffCard || 0,
                        tefSenffCardPercent: fileData.percentTefSenffCard || 0,
                        eloDebito: fileData.eloDebito || 0,
                        eloDebitoPercent: fileData.percentEloDebito || 0,
                        eloCredito: fileData.eloCredito || 0,
                        eloCreditoPercent: fileData.percentEloCredito || 0,
                        pamcardFrota: fileData.pamcardFrota || 0,
                        pamcardFrotaPercent: fileData.percentPamcardFrota || 0,
                        x7Bank: fileData.x7Bank || 0,
                        x7BankPercent: fileData.percentX7Bank || 0,
                        tefFlexFrota: fileData.tefFlexFrota || 0,
                        tefFlexFrotaPercent: fileData.percentTefFlexFrota || 0,
                        aleloAutoCredi: fileData.aleloAutoCredi || 0,
                        aleloAutoCrediPercent: fileData.percentAleloAutoCredi || 0,
                        fitcardCredito: fileData.fitcardCredito || 0,
                        fitcardCreditoPercent: fileData.percentFitcardCredito || 0,
                        repomSaque: fileData.repomSaque || 0,
                        repomSaquePercent: fileData.percentRepomSaque || 0,
                        redeFrotaDebito: fileData.redeFrotaDebito || 0,
                        redeFrotaDebitoPercent: fileData.percentRedeFrotaDebito || 0,
                        tefPolicard: fileData.tefPolicard || 0,
                        tefPolicardPercent: fileData.percentTefPolicard || 0,
                        tefVrBenefic: fileData.tefVrBenefic || 0,
                        tefVrBeneficPercent: fileData.percentTefVrBenefic || 0,
                        bamex: fileData.bamex || 0,
                        bamexPercent: fileData.percentBamex || 0,
                        vrBeneficios: fileData.vrBeneficios || 0,
                        vrBeneficiosPercent: fileData.percentVrBeneficios || 0,
                        motivoTef: fileData.motivoTef || 0,
                        motivoTefPercent: fileData.percentMotivoTef || 0,
                        saqjaStoneNovo: fileData.saqjaStoneNovo || 0,
                        saqjaStoneNovoPercent: fileData.percentSaqjaStoneNovo || 0,
                        tefBrasilCar: fileData.tefBrasilCar || 0,
                        tefBrasilCarPercent: fileData.percentTefBrasilCar || 0,
                        tefCabalCred: fileData.tefCabalCred || 0,
                        tefCabalCredPercent: fileData.percentTefCabalCred || 0,
                        tefCabalDebi: fileData.tefCabalDebi || 0,
                        tefCabalDebiPercent: fileData.percentTefCabalDebi || 0,
                        tefPersonalC: fileData.tefPersonalC || 0,
                        tefPersonalCPercent: fileData.percentTefPersonalC || 0,
                        total: fileData.totalVendas,
                        timestamp: new Date().toISOString()
                    };

                    if (existingIndex >= 0) {
                        salesData[existingIndex] = newData;
                    } else {
                        salesData.push(newData);
                    }
                } catch (error) {
                    console.error(`Erro ao processar o arquivo ${file.name}:`, error);
                }
            }

            filteredData = [...salesData];
            loadingSpinner.style.display = 'none';
            setDefaultCheckboxes();
            saveData();
            updateDisplay();
            showSuccessMessage(`${files.length} arquivo(s) processado(s) com sucesso!`);
        }

        function showSuccessMessage(message) {
            successMessage.innerHTML = `
                <div class="success-message">
                    <i class="fas fa-check-circle"></i>
                    ${message}
                </div>
            `;
            successMessage.style.display = 'block';
            setTimeout(() => {
                successMessage.style.display = 'none';
            }, 3000);
        }

        function handleSearch() {
            const searchTerm = searchInput.value.toLowerCase();
            filteredData = salesData.filter(data => 
                data.fileName.toLowerCase().includes(searchTerm)
            );
            if (sortOrder) {
                sortData(sortOrder);
            } else {
                updateDisplay();
            }
        }

        function sortData(order) {
            sortOrder = order;
            filteredData.sort((a, b) => {
                if (order === 'asc') {
                    return a.onSightPercent - b.onSightPercent;
                } else {
                    return b.onSightPercent - a.onSightPercent;
                }
            });
            updateDisplay();
        }

       function updateDisplay() {
    // Atualizar o contador de empresas
    document.getElementById('companyCount').textContent = filteredData.length;
    
    updateColumnVisibility();
    updateTable();
    updateStats();
    updateChart();
    updatePrintDate();
}

        function updatePrintDate() {
            const now = new Date();
            printDate.textContent = now.toLocaleString('pt-BR');
        }

        function updateColumnVisibility() {
            document.querySelectorAll('th, td').forEach(el => {
                el.classList.remove('hidden-column');
            });

            checkboxes.forEach(checkbox => {
                const value = checkbox.value;
                if (!checkbox.checked && columnMap[value]) {
                    columnMap[value].forEach(colClass => {
                        document.querySelectorAll(`.${colClass}`).forEach(el => {
                            el.classList.add('hidden-column');
                        });
                    });
                }
            });
        }

        function updateStats() {
            statsCards.innerHTML = '';
            const selectedTypes = checkboxes.filter(checkbox => checkbox.checked).map(checkbox => checkbox.value);
            const grandTotal = filteredData.reduce((sum, data) => sum + data.total, 0);

            const totalCard = document.createElement('div');
            totalCard.className = 'stat-card';
            totalCard.innerHTML = `
                <div class="flex items-center justify-between">
                    <div>
                        <p class="text-sm font-medium text-gray-600">Total de Vendas</p>
                        <p class="text-2xl font-bold text-gray-900">${formatarValor(grandTotal)}</p>
                    </div>
                    <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center">
                        <i class="fas fa-dollar-sign text-blue-600 text-xl"></i>
                    </div>
                </div>
            `;
            statsCards.appendChild(totalCard);

            selectedTypes.forEach(type => {
                const total = filteredData.reduce((sum, data) => sum + data[type], 0);
                const card = document.createElement('div');
                card.className = 'stat-card';
                card.innerHTML = `
                    <div class="flex items-center justify-between">
                        <div>
                            <p class="text-sm font-medium text-gray-600">${paymentTypes[type].label}</p>
                            <p class="text-2xl font-bold text-gray-900">${formatarValor(total)}</p>
                        </div>
                        <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center">
                            <i class="fas ${paymentTypes[type].icon} text-blue-600 text-xl"></i>
                        </div>
                    </div>
                `;
                statsCards.appendChild(card);
            });
        }

        function updateTable() {
            tableHeader.innerHTML = '';
            tableBody.innerHTML = '';
            tableFooter.innerHTML = '';

            const selectedTypes = checkboxes.filter(checkbox => checkbox.checked).map(checkbox => checkbox.value);

            // Create table header
            let headerHtml = '<tr><th><i class="fas fa-building mr-2"></i>Empresa</th>';
            selectedTypes.forEach(type => {
                headerHtml += `
                    <th class="text-right ${type}-column"><i class="fas ${paymentTypes[type].icon} mr-2"></i>${paymentTypes[type].label}</th>
                    <th class="text-right ${type}-percent-column"><i class="fas fa-percentage mr-2"></i>% ${paymentTypes[type].label}</th>
                `;
            });
            headerHtml += '<th class="text-right"><i class="fas fa-dollar-sign mr-2"></i>Total de Vendas</th></tr>';
            tableHeader.innerHTML = headerHtml;

            // Create table body
            filteredData.forEach(data => {
                const row = document.createElement('tr');
                let rowHtml = `<td class="font-medium">${data.fileName}</td>`;
                selectedTypes.forEach(type => {
                    rowHtml += `
                        <td class="text-right ${type}-column">${formatarValor(data[type])}</td>
                        <td class="text-right ${type}-percent-column">${data[`${type}Percent`]?.toFixed(2)}%</td>
                    `;
                });
                rowHtml += `<td class="text-right font-semibold">${formatarValor(data.total)}</td>`;
                row.innerHTML = rowHtml;
                tableBody.appendChild(row);
            });

            // Create table footer
            if (filteredData.length > 0) {
                const totals = {};
                const percents = {};
                selectedTypes.forEach(type => {
                    totals[type] = filteredData.reduce((sum, data) => sum + data[type], 0);
                    percents[type] = filteredData.reduce((sum, data) => sum + (data[`${type}Percent`] || 0), 0);
                });
                const grandTotal = filteredData.reduce((sum, data) => sum + data.total, 0);

                const footerRow = document.createElement('tr');
                let footerHtml = '<td class="font-bold text-gray-900">TOTAL GERAL</td>';
                selectedTypes.forEach(type => {
                    footerHtml += `
                        <td class="text-right font-bold text-gray-900 ${type}-column">${formatarValor(totals[type])}</td>
                        <td class="text-right font-bold text-gray-900 ${type}-percent-column">${((totals[type] / grandTotal) * 100).toFixed(2)}%</td>
                    `;
                });
                footerHtml += `<td class="text-right font-bold text-gray-900">${formatarValor(grandTotal)}</td>`;
                footerRow.innerHTML = footerHtml;
                tableFooter.appendChild(footerRow);
            }

            updateColumnVisibility();
        }

        function updateChart() {
            if (typeof Chart === 'undefined') {
                console.error('Chart.js não foi carregado.');
                printValues.innerHTML = '<p>Erro: Chart.js não carregado.</p>';
                return;
            }

            const ctx = document.getElementById('salesChart')?.getContext('2d');
            if (!ctx) {
                console.error('Canvas com ID "salesChart" não encontrado.');
                printValues.innerHTML = '<p>Erro: Elemento de canvas não encontrado.</p>';
                return;
            }

            if (chartInstance) {
                chartInstance.destroy();
            }

            if (!filteredData || filteredData.length === 0) {
                console.warn('Nenhum dado disponível em filteredData.');
                printValues.innerHTML = '<p>Nenhum dado disponível.</p>';
                return;
            }

            const selectedTypes = checkboxes
                .filter(checkbox => checkbox.checked)
                .map(checkbox => checkbox.value);
            const datasets = [];

            const colors = [
                '#eab308', '#8b5cf6', '#ef4444', '#10b981', '#3b82f6', '#f97316', '#06b6d4',
                '#8b5cf6', '#ec4899', '#14b8a6', '#f59e0b', '#84cc16', '#0ea5e9', '#a855f7',
                '#d946ef', '#f43f5e', '#22d3ee', '#f472b6', '#fb923c', '#4ade80', '#38bdf8',
                '#c084fc', '#e879f9', '#fb7185', '#2dd4bf', '#fbbf24', '#34d399', '#60a5fa',
                '#a78bfa', '#f87171', '#818cf8', '#f472b6', '#fb923c', '#4ade80', '#38bdf8',
                '#c084fc', '#e879f9', '#fb7185', '#2dd4bf', '#fbbf24', '#34d399', '#60a5fa',
                '#a78bfa', '#f87171', '#818cf8', '#f472b6', '#fb923c', '#4ade80', '#38bdf8'
            ];

            selectedTypes.forEach((type, index) => {
                if (filteredData[0][type] !== undefined) {
                    datasets.push({
                        label: paymentTypes[type].label,
                        data: filteredData.map(data => data[type]),
                        borderColor: colors[index % colors.length],
                        backgroundColor: `${colors[index % colors.length]}20`,
                        borderWidth: 2,
                        tension: 0.3,
                        fill: false,
                        pointBackgroundColor: colors[index % colors.length],
                        pointRadius: 4,
                        pointHoverRadius: 7
                    });
                }
            });

            const totals = {};
            selectedTypes.forEach(type => {
                totals[type] = filteredData.reduce((sum, data) => sum + (data[type] || 0), 0);
            });
            
            const grandTotal = filteredData.reduce((sum, data) => sum + data.total, 0);

            printValues.innerHTML = `
                <h3 class="text-lg font-bold mb-4">Valores Detalhados</h3>
                <ul>
                    ${selectedTypes.map(type => `
                        <li><span>${paymentTypes[type].label}:</span> 
                        <strong>${formatarValor(totals[type])}</strong> (${grandTotal ? ((totals[type] / grandTotal) * 100).toFixed(2) : 0}%)</li>
                    `).join('')}
                    <li><span>Total Geral:</span> <strong>${formatarValor(grandTotal)}</strong></li>
                </ul>
            `;

            chartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: filteredData.map(data => data.fileName),
                    datasets: datasets
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: {
                            title: {
                                display: true,
                                text: 'Empresas',
                                font: {
                                    size: 14,
                                    weight: '600'
                                }
                            },
                            grid: {
                                display: false
                            },
                            ticks: {
                                autoSkip: false,
                                maxRotation: 45,
                                minRotation: 45,
                                font: {
                                    size: 12
                                }
                            }
                        },
                        y: {
                            title: {
                                display: true,
                                text: 'Valor ()',
                                font: {
                                    size: 14,
                                    weight: '600'
                                }
                            },
                            ticks: {
                                callback: function(value) {
                                    return formatarValor(value);
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                            labels: {
                                padding: 20,
                                font: {
                                    size: 14,
                                    weight: '600'
                                },
                                usePointStyle: true,
                                pointStyle: 'circle',
                                color: '#374151'
                            }
                        },
                        title: {
                            display: true,
                            text: 'Vendas por Forma de Pagamento por Empresa',
                            font: {
                                size: 20,
                                weight: 'bold'
                            },
                            padding: {
                                top: 20,
                                bottom: 30
                            },
                            color: '#374151'
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.8)',
                            titleFont: {
                                size: 16,
                                weight: '600'
                            },
                            bodyFont: {
                                size: 14
                            },
                            padding: 12,
                            cornerRadius: 8,
                            callbacks: {
                                label: function(context) {
                                    const label = context.dataset.label;
                                    const value = context.raw;
                                    const percentage = grandTotal ? ((value / grandTotal) * 100).toFixed(2) : 0;
                                    return `${label}: ${formatarValor(value)} (${percentage}%)`;
                                }
                            }
                        }
                    },
                    animation: {
                        duration: 2000,
                        easing: 'easeInOutQuart'
                    }
                }
            });
        }

        function exportToCSV() {
            if (filteredData.length === 0) {
                alert('Nenhum dado para exportar!');
                return;
            }

            const selectedTypes = checkboxes.filter(checkbox => checkbox.checked).map(checkbox => checkbox.value);
            const headers = ['Empresa'];
            selectedTypes.forEach(type => {
                headers.push(paymentTypes[type].label);
                headers.push(`% ${paymentTypes[type].label}`);
            });
            headers.push('Total de Vendas');

            const csvContent = [
                headers.join(','),
                ...filteredData.map(data => {
                    const row = [`"${data.fileName}"`];
                    selectedTypes.forEach(type => {
                        row.push(data[type]?.toFixed(2) || '0.00');
                        row.push(data[`${type}Percent`]?.toFixed(2) || '0.00');
                    });
                    row.push(data.total.toFixed(2));
                    return row.join(',');
                })
            ].join('\n');

            const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = `relatorio_vendas_${new Date().toISOString().split('T')[0]}.csv`;
            link.click();

            showSuccessMessage('Relatório exportado com sucesso!');
        }

        function clearAllData() {
            if (confirm('Tem certeza que deseja limpar todos os dados? Esta ação não pode ser desfeita.')) {
                salesData = [];
                filteredData = [];
                sortOrder = null;
                searchInput.value = '';
                setDefaultCheckboxes();
                localStorage.removeItem('salesReportData');
                updateDisplay();
                if (chartInstance) {
                    chartInstance.destroy();
                    chartInstance = null;
                }
                showSuccessMessage('Todos os dados foram limpos!');
            }
        }

        function uncheckAllCheckboxes() {
            checkboxes.forEach(checkbox => {
                checkbox.checked = false;
            });
            updateDisplay();
        }

        async function extractDataFromPDF(file) {
            return new Promise((resolve, reject) => {
                const fileReader = new FileReader();

                fileReader.onload = async function() {
                    try {
                        const typedArray = new Uint8Array(this.result);
                        const pdf = await pdfjsLib.getDocument(typedArray).promise;
                        const page = await pdf.getPage(1);
                        const textContent = await page.getTextContent();

                        const lines = [];
                        let currentLine = '';

                        textContent.items.forEach((item, index) => {
                            if (item.str.includes('\n') || (item.transform[4] < (textContent.items[index-1]?.transform[4] || 0))) {
                                if (currentLine.trim() !== '') {
                                    lines.push(currentLine.trim());
                                }
                                currentLine = item.str;
                            } else {
                                currentLine += item.str;
                            }
                        });

                        if (currentLine.trim() !== '') {
                            lines.push(currentLine.trim());
                        }

                        const tableData = [];
                        let inTable = false;

                        lines.forEach(line => {
                            if (line.includes('Rótulo') && line.includes('%') && line.includes('Valor')) {
                                inTable = true;
                                return;
                            }

                            if (inTable && line.trim() !== '') {
                                const columns = line.split(/\s+/).filter(Boolean);

                                if (columns.length >= 3) {
                                    const label = columns.slice(0, -2).join(' ');
                                    const percent = columns[columns.length - 2];
                                    const value = columns[columns.length - 1];

                                    tableData.push({
                                        label,
                                        percent: parseFloat(percent.replace(',', '.')),
                                        value: parseFloat(value.replace(/\./g, '').replace(',', '.'))
                                    });
                                }
                            }
                        });

                        const result = {};

                        const extractValue = (pattern) => {
                            const item = tableData.find(i => i.label.match(pattern)) || { percent: 0, value: 0 };
                            return {
                                value: item.value,
                                percent: item.percent
                            };
                        };

                        const dinheiro = extractValue(/DINHEIRO/i);
                        const notasAPrazo = extractValue(/NOTAS A PRAZO|NOTAS À PRAZO/i);
                        const chequeAVista = extractValue(/CHEQUE A VISTA/i);
                        const chequePreDatado = extractValue(/CHEQUE PRE DATADO|CHEQUE PRÉ-DATADO/i);
                        const tefTicketLog = extractValue(/TEF - CARTAO TICKET LOG/i);
                        const redeFrotaCredito = extractValue(/REDE FROTA CREDITO - AB/i);
                        const tefMastercard = extractValue(/TEF - MASTERCARD CREDIT/i);
                        const pixStone = extractValue(/PIX \(STONE\)/i);
                        const proFrotas = extractValue(/PRO FROTAS/i);
                        const tefVisaElectron = extractValue(/TEF - VISA ELECTRON/i);
                        const tefMasterMaestr = extractValue(/TEF - MASTERCARD MAESTR/i);
                        const ctf = extractValue(/CTF/i);
                        const tefTruckPag = extractValue(/TEF - CARTAO TRUCK PAG/i);
                        const tefVisaCredi = extractValue(/TEF - CARTAO VISA CREDI/i);
                        const qrLinxPix = extractValue(/QR LINX - PIX/i);
                        const tefAleloAuto = extractValue(/TEF - CARTAO ALELO AUTO/i);
                        const tefCtfTef = extractValue(/TEF - CARTAO CTF TEF/i);
                        const truckPagAbaste = extractValue(/CARTAO TRUCK PAG ABASTE/i);
                        const tefValeCard = extractValue(/TEF - CARTAO VALE CARD/i);
                        const tefEloDebito = extractValue(/TEF - CARTAO ELO DEBITO/i);
                        const tefEloCredit = extractValue(/TEF - CARTAO ELO CREDIT/i);
                        const visaDebito = extractValue(/CARTAO VISA DEBITO/i);
                        const targetPay = extractValue(/TARGET PAY/i);
                        const cartaFrete = extractValue(/CARTA FRETE/i);
                        const visaCredito = extractValue(/CARTAO VISA CREDITO/i);
                        const masterCardCred = extractValue(/CARTAO MASTER CARD CRED/i);
                        const tefVisaElectronLio = extractValue(/TEF - VISA ELECTRON LIO/i);
                        const redeSempre = extractValue(/CARTAO REDE SEMPRE/i);
                        const repomAbasteci = extractValue(/CARTAO REPOM - ABASTECI/i);
                        const tefMaxiFrota = extractValue(/TEF - CARTAO MAXI FROTA/i);
                        const tefSodexoWiz = extractValue(/TEF - CARTAO SODEXO WIZ/i);
                        const novoAbasteceAi = extractValue(/CARTAO NOVO ABASTECE AI/i);
                        const masterCardDebi = extractValue(/CARTAO MASTER CARD DEBI/i);
                        const tefSouthAmer = extractValue(/TEF - CARTAO SOUTH AMER/i);
                        const eFrete = extractValue(/E-FRETE/i);
                        const tefAmericanE = extractValue(/TEF - CARTAO AMERICAN E/i);
                        const ticketLog = extractValue(/CARTAO TICKET LOG/i);
                        const fleetcardCredito = extractValue(/CARTAO FLEETCARD CREDIT/i);
                        const tefFitcardCr = extractValue(/TEF - CARTAO FITCARD CR/i);
                        const southAmerica = extractValue(/CARTAO SOUTH AMERICA/i);
                        const tefSenffCard = extractValue(/TEF - CARTAO SENFF CARD/i);
                        const eloDebito = extractValue(/CARTAO ELO DEBITO/i);
                        const eloCredito = extractValue(/CARTAO ELO CREDITO/i);
                        const pamcardFrota = extractValue(/CARTAO PAMCARD FROTA \+/i);
                        const x7Bank = extractValue(/CARTAO X7 BANK/i);
                        const tefFlexFrota = extractValue(/TEF - CARTAO FLEX FROTA/i);
                        const aleloAutoCredi = extractValue(/CARTAO ALELO AUTO CREDI/i);
                        const fitcardCredito = extractValue(/CARTAO FITCARD CREDITO/i);
                        const repomSaque = extractValue(/CARTAO REPOM - SAQUE/i);
                        const redeFrotaDebito = extractValue(/REDE FROTA DEBITO/i);
                        const tefPolicard = extractValue(/TEF - CARTAO POLICARD/i);
                        const tefVrBenefic = extractValue(/TEF - CARTAO VR BENEFIC/i);
                        const bamex = extractValue(/CARTAO BAMEX/i);
                        const vrBeneficios = extractValue(/CARTAO VR BENEFICIOS/i);
                        const motivoTef = extractValue(/MOTIVO GENERICO DE TEF/i);
                        const saqjaStoneNovo = extractValue(/SAQJA STONE NOVO/i);
                        const tefBrasilCar = extractValue(/TEF - CARTAO BRASIL CAR/i);
                        const tefCabalCred = extractValue(/TEF - CARTAO CABAL CRED/i);
                        const tefCabalDebi = extractValue(/TEF - CARTAO CABAL DEBI/i);
                        const tefPersonalC = extractValue(/TEF - CARTAO PERSONAL C/i);

                        let totalVendas = 0;
                        for (let i = lines.length - 1; i >= 0; i--) {
                            if (lines[i].includes('Total')) {
                                const totalParts = lines[i].split(/\s+/);
                                const totalValue = totalParts[totalParts.length - 1];
                                if (totalValue) {
                                    totalVendas = parseFloat(totalValue.replace(/\./g, '').replace(',', '.'));
                                }
                                break;
                            }
                        }

                        Object.assign(result, {
                            dinheiro: dinheiro.value,
                            percentDinheiro: dinheiro.percent,
                            notasAPrazo: notasAPrazo.value,
                            percentNotasAPrazo: notasAPrazo.percent,
                            chequePreDatado: chequePreDatado.value,
                            percentChequePreDatado: chequePreDatado.percent,
                            chequeAVista: chequeAVista.value,
                            percentChequeAVista: chequeAVista.percent,
                            tefTicketLog: tefTicketLog.value,
                            percentTefTicketLog: tefTicketLog.percent,
                            redeFrotaCredito: redeFrotaCredito.value,
                            percentRedeFrotaCredito: redeFrotaCredito.percent,
                            tefMastercard: tefMastercard.value,
                            percentTefMastercard: tefMastercard.percent,
                            pixStone: pixStone.value,
                            percentPixStone: pixStone.percent,
                            proFrotas: proFrotas.value,
                            percentProFrotas: proFrotas.percent,
                            tefVisaElectron: tefVisaElectron.value,
                            percentTefVisaElectron: tefVisaElectron.percent,
                            tefMasterMaestr: tefMasterMaestr.value,
                            percentTefMasterMaestr: tefMasterMaestr.percent,
                            ctf: ctf.value,
                            percentCtf: ctf.percent,
                            tefTruckPag: tefTruckPag.value,
                            percentTefTruckPag: tefTruckPag.percent,
                            tefVisaCredi: tefVisaCredi.value,
                            percentTefVisaCredi: tefVisaCredi.percent,
                            qrLinxPix: qrLinxPix.value,
                            percentQrLinxPix: qrLinxPix.percent,
                            tefAleloAuto: tefAleloAuto.value,
                            percentTefAleloAuto: tefAleloAuto.percent,
                            tefCtfTef: tefCtfTef.value,
                            percentTefCtfTef: tefCtfTef.percent,
                            truckPagAbaste: truckPagAbaste.value,
                            percentTruckPagAbaste: truckPagAbaste.percent,
                            tefValeCard: tefValeCard.value,
                            percentTefValeCard: tefValeCard.percent,
                            tefEloDebito: tefEloDebito.value,
                            percentTefEloDebito: tefEloDebito.percent,
                            tefEloCredit: tefEloCredit.value,
                            percentTefEloCredit: tefEloCredit.percent,
                            visaDebito: visaDebito.value,
                            percentVisaDebito: visaDebito.percent,
                            targetPay: targetPay.value,
                            percentTargetPay: targetPay.percent,
                            cartaFrete: cartaFrete.value,
                            percentCartaFrete: cartaFrete.percent,
                            visaCredito: visaCredito.value,
                            percentVisaCredito: visaCredito.percent,
                            masterCardCred: masterCardCred.value,
                            percentMasterCardCred: masterCardCred.percent,
                            tefVisaElectronLio: tefVisaElectronLio.value,
                            percentTefVisaElectronLio: tefVisaElectronLio.percent,
                            redeSempre: redeSempre.value,
                            percentRedeSempre: redeSempre.percent,
                            repomAbasteci: repomAbasteci.value,
                            percentRepomAbasteci: repomAbasteci.percent,
                            tefMaxiFrota: tefMaxiFrota.value,
                            percentTefMaxiFrota: tefMaxiFrota.percent,
                            tefSodexoWiz: tefSodexoWiz.value,
                            percentTefSodexoWiz: tefSodexoWiz.percent,
                            novoAbasteceAi: novoAbasteceAi.value,
                            percentNovoAbasteceAi: novoAbasteceAi.percent,
                            masterCardDebi: masterCardDebi.value,
                            percentMasterCardDebi: masterCardDebi.percent,
                            tefSouthAmer: tefSouthAmer.value,
                            percentTefSouthAmer: tefSouthAmer.percent,
                            eFrete: eFrete.value,
                            percentEFrete: eFrete.percent,
                            tefAmericanE: tefAmericanE.value,
                            percentTefAmericanE: tefAmericanE.percent,
                            ticketLog: ticketLog.value,
                            percentTicketLog: ticketLog.percent,
                            fleetcardCredito: fleetcardCredito.value,
                            percentFleetcardCredito: fleetcardCredito.percent,
                            tefFitcardCr: tefFitcardCr.value,
                            percentTefFitcardCr: tefFitcardCr.percent,
                            southAmerica: southAmerica.value,
                            percentSouthAmerica: southAmerica.percent,
                            tefSenffCard: tefSenffCard.value,
                            percentTefSenffCard: tefSenffCard.percent,
                            eloDebito: eloDebito.value,
                            percentEloDebito: eloDebito.percent,
                            eloCredito: eloCredito.value,
                            percentEloCredito: eloCredito.percent,
                            pamcardFrota: pamcardFrota.value,
                            percentPamcardFrota: pamcardFrota.percent,
                            x7Bank: x7Bank.value,
                            percentX7Bank: x7Bank.percent,
                            tefFlexFrota: tefFlexFrota.value,
                            percentTefFlexFrota: tefFlexFrota.percent,
                            aleloAutoCredi: aleloAutoCredi.value,
                            percentAleloAutoCredi: aleloAutoCredi.percent,
                            fitcardCredito: fitcardCredito.value,
                            percentFitcardCredito: fitcardCredito.percent,
                            repomSaque: repomSaque.value,
                            percentRepomSaque: repomSaque.percent,
                            redeFrotaDebito: redeFrotaDebito.value,
                            percentRedeFrotaDebito: redeFrotaDebito.percent,
                            tefPolicard: tefPolicard.value,
                            percentTefPolicard: tefPolicard.percent,
                            tefVrBenefic: tefVrBenefic.value,
                            percentTefVrBenefic: tefVrBenefic.percent,
                            bamex: bamex.value,
                            percentBamex: bamex.percent,
                            vrBeneficios: vrBeneficios.value,
                            percentVrBeneficios: vrBeneficios.percent,
                            motivoTef: motivoTef.value,
                            percentMotivoTef: motivoTef.percent,
                            saqjaStoneNovo: saqjaStoneNovo.value,
                            percentSaqjaStoneNovo: saqjaStoneNovo.percent,
                            tefBrasilCar: tefBrasilCar.value,
                            percentTefBrasilCar: tefBrasilCar.percent,
                            tefCabalCred: tefCabalCred.value,
                            percentTefCabalCred: tefCabalCred.percent,
                            tefCabalDebi: tefCabalDebi.value,
                            percentTefCabalDebi: tefCabalDebi.percent,
                            tefPersonalC: tefPersonalC.value,
                            percentTefPersonalC: tefPersonalC.percent,
                            totalVendas
                        });

                        resolve(result);
                    } catch (error) {
                        reject(error);
                    }
                };

                fileReader.onerror = () => reject(fileReader.error);
                fileReader.readAsArrayBuffer(file);
            });
        }

        // Inicializar com checkboxes padrão
        window.addEventListener('DOMContentLoaded', () => {
            setDefaultCheckboxes();
            updateDisplay();
        });
// Funções para rolagem
document.getElementById('scrollToTop').addEventListener('click', () => {
    window.scrollTo({ top: 0, behavior: 'smooth' });
});

document.getElementById('scrollToBottom').addEventListener('click', () => {
    window.scrollTo({ top: document.body.scrollHeight, behavior: 'smooth' });
});
//credito e débito 

// Função para selecionar todos os checkboxes de crédito
function selectCreditCheckboxes() {
    const creditTypes = [
        'tefMaster', 'tefVisa', 'tefVisaCredi', 'tefEloCredit',
        'visaCredito', 'masterCardCred', 'eloCredito'
    ];
    checkboxes.forEach(checkbox => {
        checkbox.checked = creditTypes.includes(checkbox.value);
    });
    updateDisplay();
}

// Função para selecionar todos os checkboxes de débito
function selectDebitCheckboxes() {
    const debitTypes = [
        'tefMasterMaestr', 'tefEloDebito', 'visaDebito',
        'masterCardDebi', 'eloDebito'
    ];
    checkboxes.forEach(checkbox => {
        checkbox.checked = debitTypes.includes(checkbox.value);
    });
    updateDisplay();
}

// Função para selecionar todos os checkboxes de Cartão Frotas
function selectFleetCheckboxes() {
    const fleetTypes = [
        'tefTicket',         // TEF - Ticket Log
        'redeFrota',         // Rede Frota Crédito
        'tefTruckPag',       // TEF - Truck Pag
        'tefAleloAuto',      // TEF - Alelo Auto
        'truckPagAbaste',    // Truck Pag Abaste
        'targetPay',         // Target Pay
        'redeSempre',        // Rede Sempre
        'repomAbasteci',     // Repom Abasteci
        'tefMaxiFrota',      // TEF - Maxi Frota
        'tefSodexoWiz',      // TEF - Sodexo Wiz
        'novoAbasteceAi',    // Novo Abastece AI
        'tefSouthAmer',      // TEF - South Amer
        'eFrete',            // E-Frete
        'ticketLog',         // Ticket Log
        'fleetcardCredito',  // Fleetcard Crédito
        'tefFitcardCr'       // TEF - Fitcard Cr
    ];
    
    checkboxes.forEach(checkbox => {
        checkbox.checked = fleetTypes.includes(checkbox.value);
    });
    updateDisplay();
}
    </script>
</body>
</html>
</xaiArtifact>
