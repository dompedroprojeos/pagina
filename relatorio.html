<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Relat√≥rio de Demiss√£o</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            background: linear-gradient(135deg, #ffffff 0%, #f8f9fa 100%);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo-section {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .logo-placeholder {
            width: 100px;
            height: 100px;
            border: 0px dashed #667eea;
            border-radius: 0px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #667eea;
            font-size: 24px;
            transition: all 0.3s ease;
            object-fit: cover;
        }

        .logo-placeholder:hover {
            background: rgba(102, 126, 234, 0.1);
            transform: scale(1.05);
        }

        .header-text {
            flex: 1;
            text-align: center;
        }

        .header-text h1 {
            font-size: 2.5em;
            color: #2c3e50;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header-text p {
            color: #7f8c8d;
            font-size: 1.1em;
        }

        .dashboard-controls {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
        }

        .input-group {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
        }

        .input-container {
            flex: 1;
        }

        .input-container label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
        }

        .input-container textarea {
            width: 100%;
            min-height: 120px;
            padding: 15px;
            border: 2px solid #e3f2fd;
            border-radius: 12px;
            font-size: 14px;
            resize: vertical;
            transition: all 0.3s ease;
        }

        .input-container textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%);
            color: white;
        }

        .btn-secondary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 107, 107, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #2ecc71 0%, #27ae60 100%);
            color: white;
        }

        .btn-success:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(46, 204, 113, 0.4);
        }

        .report-container {
            background: rgba(255,255,255,0.95);
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            min-height: 400px;
        }

        .report-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid #eee;
        }

        .report-header h2 {
            font-size: 2em;
            color: #2c3e50;
            margin-bottom: 10px;
        }

        .report-item {
            background: linear-gradient(135deg, #f8f9fa 0%, #ffffff 100%);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border-left: 5px solid #667eea;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
        }

        .report-item:hover {
            transform: translateX(5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .report-item h3 {
            color: #2c3e50;
            margin-bottom: 15px;
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }

        .info-item {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            background: rgba(102, 126, 234, 0.1);
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .info-item:hover {
            background: rgba(102, 126, 234, 0.2);
            transform: scale(1.02);
        }

        .rating {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .rating-faces {
            font-size: 1.2em;
            margin-left: 10px;
        }

        .face-bad { color: #e74c3c; }
        .face-ok { color: #f39c12; }
        .face-good { color: #27ae60; }

        .total-score {
            text-align: center;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            color: white;
            margin-top: 15px;
        }

        .total-score h4 {
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        .score-details {
            display: flex;
            justify-content: space-around;
            text-align: center;
        }

        .score-item {
            flex: 1;
        }

        .score-item .value {
            font-size: 2em;
            font-weight: bold;
            display: block;
        }

        .score-item .label {
            font-size: 0.9em;
            opacity: 0.9;
        }

        .empty-state {
            text-align: center;
            padding: 60px 20px;
            color: #7f8c8d;
        }

        .empty-state i {
            font-size: 4em;
            margin-bottom: 20px;
            opacity: 0.3;
        }

        .empty-state h3 {
            font-size: 1.5em;
            margin-bottom: 10px;
        }

        .footer {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            text-align: center;
            padding: 30px;
            border-radius: 20px;
            margin-top: 30px;
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
        }

        .psychologist-info {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .psychologist-logo {
            width: 90px;
            height: 90px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
        }

        .psychologist-text h4 {
            margin-bottom: 5px;
            font-size: 1.2em;
        }

        .psychologist-text p {
            color: #bdc3c7;
            font-size: 0.9em;
        }

        .creator-info {
            text-align: right;
        }

        .creator-info p {
            margin-bottom: 5px;
            color: #bdc3c7;
        }

        .creator-info .year {
            font-size: 1.1em;
            font-weight: bold;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in-up {
            animation: fadeInUp 0.6s ease-out;
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                text-align: center;
                gap: 20px;
            }

            .input-group {
                flex-direction: column;
            }

            .buttons {
                flex-direction: column;
                align-items: center;
            }

            .btn {
                width: 100%;
                max-width: 300px;
            }

            .footer-content {
                flex-direction: column;
                text-align: center;
            }

            .creator-info {
                text-align: center;
            }
        }
.highlight {
    background: rgba(255, 255, 255, 0.2);
    border-radius: 8px;
    padding: 5px;
}

.final-score {
    margin-top: 15px;
    padding-top: 10px;
    border-top: 1px dashed rgba(255,255,255,0.3);
    text-align: center;
}

.final-value {
    font-size: 1.8em;
    font-weight: bold;
    display: block;
    color: #ffffff;
}

.final-label {
    font-size: 0.9em;
    opacity: 0.9;
    color: #ffffff;
}
.rating {
    font-size: 0.8em;
    font-weight: bold;
    padding: 3px 8px;
    border-radius: 12px;
    background: rgba(0,0,0,0.1);
    margin-left: 5px;
}

.final-classification {
    margin-top: 15px;
    padding: 10px;
    text-align: center;
    font-weight: bold;
    font-size: 1.1em;
    border-radius: 8px;
    background: rgba(0,0,0,0.1);
}
  @media print {
        .print-icon {
            display: inline !important; /* Garante que o √≠cone seja exibido na impress√£o */
            font-size: 24px; /* Ajuste o tamanho se necess√°rio */
        }

        .psychologist-logo {
            display: none; /* Remove a bolinha roxa antes do nome */
        }
    }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="header-content">
                <div class="logo-section">
                    <img src="logodivertido.jpg" alt="Logo da Empresa" class="logo-placeholder">
                </div>
                <div class="header-text">
                    <h1>Sistema de Relat√≥rio de Demiss√£o</h1>
                    <p>An√°lise Profissional de Entrevistas de Demiss√£o</p>
                </div>
            </div>
        </div>

        <div class="dashboard-controls">
            <div class="input-group">
                <div class="input-container">
                    <label for="reportData">
                        <i class="fas fa-clipboard-list"></i> Dados do Relat√≥rio
                    </label>
                    <textarea 
                        id="reportData" 
                        placeholder="Cole aqui os dados da entrevista de demiss√£o no formato:
üìã *Entrevista de Desligamento* ou üìù *Formul√°rio de Pedido de Demiss√£o* ou üìã *Avalia√ß√£o de Demiss√£o*
üë§ *Gerente*: Nome do Gerente
‚≠ê *Nota do Gerente*: X/5
ü§ù *Nota da Equipe*: X/5
üè¢ *Nota da Estrutura*: X/5
üéÅ *Nota dos Benef√≠cios*: X/5
üìä *Total*: XX/20
üìà *M√©dia*: X.X/10 (Classifica√ß√£o)
‚ùì *Motivos* ou *Desligamento Claro*: Descri√ß√£o
üí¨ *Observa√ß√µes* ou *Coment√°rios*: Coment√°rios"
                    ></textarea>
                </div>
            </div>
            <div class="buttons">
                <button class="btn btn-primary" onclick="processReport()">
                    <i class="fas fa-cogs"></i> Processar Relat√≥rio
                </button>
                <button class="btn btn-success" onclick="printReport()">
                    <i class="fas fa-print"></i> Imprimir
                </button>
                <button class="btn btn-secondary" onclick="clearReport()">
                    <i class="fas fa-trash"></i> Limpar
                </button>
            </div>
        </div>

        <div class="report-container" id="reportContainer">
            <div class="empty-state">
                <i class="fas fa-chart-line"></i>
                <h3>Aguardando Dados</h3>
                <p>Cole os dados da entrevista de demiss√£o no campo acima e clique em "Processar Relat√≥rio"</p>
            </div>
        </div>

        <div class="footer">
            <div class="footer-content">
                <div class="psychologist-info">
                    <div class="psychologist-logo">
                        <i class="fas fa-brain"></i>
                    </div>
                    <div class="psychologist-text">
                        <h4>Sandra Rodrigues</h4>
                        <p>Psic√≥loga</p>
                    </div>
                </div>
                <div class="creator-info">
                    <p></p>
                    <p><strong>Sistema - Entrevistas de Demiss√£o</strong></p>
                    <p class="year">¬© 2025-war</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        let reportData = [];

        function getScoreFace(score, maxScore) {
            const percentage = (score / maxScore) * 100;
            if (percentage >= 80) return '<span class="face-good">üòä</span>';
            if (percentage >= 60) return '<span class="face-ok">üòê</span>';
            return '<span class="face-bad">üòû</span>';
        }

function getAverageClassification(average) {
    // Considerando que a m√©dia vem em escala de 0-5
    if (average >= 4.5) return { text: 'Excelente', color: '#27ae60' };
    if (average >= 4) return { text: 'Muito Bom', color: '#2ecc71' };
    if (average >= 3) return { text: 'Bom', color: '#f39c12' };
    if (average >= 2) return { text: 'Regular', color: '#e67e22' };
    if (average >= 1) return { text: 'Ruim', color: '#e74c3c' };
    return { text: 'P√©ssimo', color: '#c0392b' };
}

     function parseReportData(text) {
    console.log('Iniciando parseReportData com texto:', text);
    const reports = [];
    
    // Primeiro normaliza quebras de linha
    const normalizedText = text.replace(/\r\n/g, '\n').replace(/\r/g, '\n');
    
    // Divide em relat√≥rios individuais
    const reportBlocks = normalizedText.split(/(?=üìã \*|\nüìã \*|Relat[√≥o]rios? de Demiss[√£a]o)/);
    
    // Remove blocos vazios
    const nonEmptyBlocks = reportBlocks.filter(block => block.trim().length > 0);
    
    console.log('Blocos encontrados:', nonEmptyBlocks.length);
    
    for (const block of nonEmptyBlocks) {
        if (!block.trim()) continue;
        
        console.log('Processando bloco:', block);
        
        const report = {
            type: '',
            manager: '',
            managerScore: 0,
            teamScore: 0,
            structureScore: 0,
            benefitsScore: 0,
            total: 0,
            average: 0,
            classification: '',
            reasons: '',
            observations: ''
        };

        // Extrai o tipo do relat√≥rio
        const typeMatch = block.match(/(?:üìã|üìù) \*(.*?)\*|Relat[√≥o]rios? de Demiss[√£a]o/);
        if (typeMatch) {
            report.type = typeMatch[1] ? typeMatch[1].trim() : 'Relat√≥rio de Demiss√£o';
        } else {
            report.type = 'Relat√≥rio de Demiss√£o';
        }

        // Extrai os campos do relat√≥rio com regex mais tolerantes
        const managerMatch = block.match(/üë§ \*Gerente\*:([^\n]+)/);
        if (managerMatch) report.manager = managerMatch[1].trim();

        const managerScoreMatch = block.match(/‚≠ê \*Nota (?:do )?Gerente\*: (\d+)\/5/);
        if (managerScoreMatch) report.managerScore = parseInt(managerScoreMatch[1]);

        const teamScoreMatch = block.match(/(?:ü§ù|üë•) \*Nota (?:da )?Equipe\*: (\d+)\/5/);
        if (teamScoreMatch) report.teamScore = parseInt(teamScoreMatch[1]);

        const structureScoreMatch = block.match(/üè¢ \*Nota (?:da )?Estrutura\*: (\d+)\/5/);
        if (structureScoreMatch) report.structureScore = parseInt(structureScoreMatch[1]);

        const benefitsScoreMatch = block.match(/üéÅ \*Nota (?:dos )?Benef√≠cios\*: (\d+)\/5/);
        if (benefitsScoreMatch) report.benefitsScore = parseInt(benefitsScoreMatch[1]);

        // Calcula ou extrai o total
        const totalMatch = block.match(/üìä \*(?:Total|Pontua√ß√£o Total)\*: (\d+)\/20/);
        if (totalMatch) {
            report.total = parseInt(totalMatch[1]);
        } else {
            report.total = report.managerScore + report.teamScore + report.structureScore + report.benefitsScore;
        }

        // Calcula ou extrai a m√©dia e classifica√ß√£o
        const averageMatch = block.match(/üìà \*M√©dia\*: ([\d.]+)\/10 \((.+?)\)/);
       if (averageMatch) {
    report.average = parseFloat(averageMatch[1]);
    // Converte para escala de 5 se estiver em 10
    report.average = report.average > 5 ? report.average / 2 : report.average;
    report.classification = averageMatch[2].trim();

        } else {
            report.average = report.total / 4;
            report.classification = getAverageClassification(report.average).text;
        }

        // Extrai motivos (com v√°rias varia√ß√µes poss√≠veis)
        const reasonsMatch = block.match(/‚ùì \*(?:Motivos|Motivos do Pedido|Desligamento Claro)\*:([^\n]+)/);
        if (reasonsMatch) report.reasons = reasonsMatch[1].trim();

        // Extrai observa√ß√µes (com v√°rias varia√ß√µes poss√≠veis)
        const observationsMatch = block.match(/(?:üí¨|üìù) \*(?:Observa√ß√µes|Coment√°rios)\*:([^\n]+)/);
        if (observationsMatch) report.observations = observationsMatch[1].trim();

        // Verifica se o relat√≥rio tem dados suficientes para ser v√°lido
        if (report.manager || report.managerScore > 0 || report.teamScore > 0 || 
            report.structureScore > 0 || report.benefitsScore > 0) {
            reports.push(report);
            console.log('Relat√≥rio v√°lido encontrado:', report);
        } else {
            console.log('Bloco ignorado por falta de dados:', block);
        }
    }

    console.log('Relat√≥rios processados:', reports);
    return reports;
}

function generateReportHTML(reports) {
    console.log('Gerando HTML para relat√≥rios:', reports);
    if (reports.length === 0) {
        console.log('Nenhum relat√≥rio para exibir');
        return `
            <div class="empty-state">
                <i class="fas fa-exclamation-triangle"></i>
                <h3>Dados N√£o Encontrados</h3>
                <p>N√£o foi poss√≠vel processar os dados. Verifique o formato e tente novamente.</p>
            </div>
        `;
    }

    let html = `<div class="report-header"><h2><i class="fas fa-file-alt"></i> Relat√≥rios Processados</h2></div>`;

    reports.forEach((report, index) => {
        const classification = getAverageClassification(report.average);
        // Mant√©m exatamente o tipo que foi colado no texto original
        const displayType = report.type || 'Relat√≥rio de Demiss√£o';
        console.log(`Exibindo relat√≥rio ${index + 1} com tipo:`, displayType);

        html += `
            <div class="report-item fade-in-up" style="animation-delay: ${index * 0.1}s">
                <h3>
                    <i class="fas fa-user-tie"></i> ${displayType}
                </h3>
                        
                        <div class="info-grid">
                            <div class="info-item">
                                <i class="fas fa-user-cog"></i>
                                <strong>Gerente:</strong> ${report.manager}
                            </div>
                            <div class="info-item">
                                <i class="fas fa-star"></i>
                                <div class="rating">
                                    <strong>Nota do Gerente:</strong> ${report.managerScore}/5
                                    <span class="rating-faces">${getScoreFace(report.managerScore, 5)}</span>
                                </div>
                            </div>
                            <div class="info-item">
                                <i class="fas fa-users"></i>
                                <div class="rating">
                                    <strong>Nota da Equipe:</strong> ${report.teamScore}/5
                                    <span class="rating-faces">${getScoreFace(report.teamScore, 5)}</span>
                                </div>
                            </div>
                            <div class="info-item">
                                <i class="fas fa-building"></i>
                                <div class="rating">
                                    <strong>Nota da Estrutura:</strong> ${report.structureScore}/5
                                    <span class="rating-faces">${getScoreFace(report.structureScore, 5)}</span>
                                </div>
                            </div>
                            <div class="info-item">
                                <i class="fas fa-gift"></i>
                                <div class="rating">
                                    <strong>Nota dos Benef√≠cios:</strong> ${report.benefitsScore}/5
                                    <span class="rating-faces">${getScoreFace(report.benefitsScore, 5)}</span>
                                </div>
                            </div>
                            <div class="info-item">
                                <i class="fas fa-question-circle"></i>
                                <strong>Motivos:</strong> ${report.reasons}
                            </div>
                        </div>

                   <div class="total-score">
    <h4><i class="fas fa-user-tie"></i> Nota Geral para An√°lise Profissional</h4>
    <div class="score-details">
        <div class="score-item">
            <span class="value">${report.total}/20</span>
            <span class="label">Pontua√ß√£o Total</span>
        </div>
        <div class="score-item">
            <span class="value">${(report.total/4).toFixed(1)}/5</span>
            <span class="label">M√©dia Geral</span>
        </div>
        <div class="score-item highlight">
            <span class="value" style="color: ${getAverageClassification(report.total/4).color}">
                ${getAverageClassification(report.total/4).text}
            </span>
            <span class="label">Classifica√ß√£o</span>
        </div>
    </div>
</div>

                        ${report.observations ? `
                            <div class="info-item" style="margin-top: 15px;">
                                <i class="fas fa-comments"></i>
                                <strong>Observa√ß√µes:</strong> ${report.observations}
                            </div>
                        ` : ''}
                    </div>
                `;
            });

          console.log('HTML gerado:', html);
    return html;
}

        function processReport() {
            const input = document.getElementById('reportData').value.trim();
            console.log('Processando relat√≥rio com entrada:', input);
            if (!input) {
                alert('Por favor, insira os dados do relat√≥rio.');
                console.log('Entrada vazia, abortando processamento');
                return;
            }

            try {
                reportData = parseReportData(input);
                console.log('Dados processados:', reportData);
                if (reportData.length === 0) {
                    console.log('Nenhum relat√≥rio v√°lido encontrado');
                    throw new Error('Nenhum relat√≥rio v√°lido encontrado');
                }
                const reportHTML = generateReportHTML(reportData);
                document.getElementById('reportContainer').innerHTML = reportHTML;
                
                sessionStorage.setItem('reportData', JSON.stringify(reportData));
                sessionStorage.setItem('reportInput', input);
                
                showNotification('Relat√≥rio processado com sucesso!', 'success');
            } catch (error) {
                console.error('Erro ao processar relat√≥rio:', error);
                showNotification('Erro ao processar o relat√≥rio. Verifique o formato dos dados.', 'error');
            }
        }

    

//impressao formulario 
function getReportTypeKeyword(reportType) {
    const typeLower = reportType.toLowerCase();
    if (typeLower.includes('desligamento')) {
        return 'Desligamento';
    } else if (typeLower.includes('demiss√£o')) {
        return 'Demiss√£o';
    } else {
        return 'Relat√≥rio';
    }
}

  function printReport() {
    if (reportData.length === 0) {
        alert('Nenhum relat√≥rio para imprimir. Processe os dados primeiro.');
        console.log('Nenhum relat√≥rio para imprimir');
        return;
    }

    const printContent = document.getElementById('reportContainer').innerHTML;

    // Determina o t√≠tulo do relat√≥rio com base no primeiro relat√≥rio (ou ajusta conforme necess√°rio)
    const reportTypeKeyword = reportData[0] ? getReportTypeKeyword(reportData[0].type) : 'Relat√≥rio';

    const iframe = document.createElement('iframe');
    iframe.style.position = 'absolute';
    iframe.style.width = '0';
    iframe.style.height = '0';
    iframe.style.border = 'none';
    document.body.appendChild(iframe);

    const doc = iframe.contentDocument || iframe.contentWindow.document;
    doc.open();
    doc.write(`
        <html>
            <head>
                <title>${reportTypeKeyword} de Demiss√£o</title>
                <style>
                    @page {
                        margin: 2cm;
                        @top-left {
                            content: "Sistema de ${reportTypeKeyword} de Demiss√£o";
                            font-size: 12px;
                            color: #666;
                        }
                        @top-right {
                            content: "Data: " date();
                            font-size: 12px;
                            color: #666;
                        }
                        @bottom-left {
                            content: "Sandra Rodrigues - Psic√≥loga";
                            font-size: 10px;
                            color: #666;
                        }
                        @bottom-right {
                            content: "P√°gina " counter(page) " de " counter(pages);
                            font-size: 10px;
                            color: #666;
                        }
                    }
                    
                    body { 
                        font-family: Arial, sans-serif; 
                        margin: 0; 
                        padding: 20px;
                        line-height: 1.6;
                    }
                    
                    .print-header {
                        border-bottom: 2px solid #667eea;
                        padding-bottom: 20px;
                        margin-bottom: 30px;
                        text-align: center;
                    }
                    
                    .print-header h1 {
                        color: #2c3e50;
                        font-size: 24px;
                        margin: 0;
                    }
                    
                    .print-header .logo-section {
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        gap: 20px;
                        margin-bottom: 15px;
                    }
                    
                    .print-header .logo-placeholder {
                        width: 60px;
                        height: 60px;
                        border: 2px solid #667eea;
                        border-radius: 10px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        font-size: 24px;
                        color: #667eea;
                        object-fit: cover;
                    }
                    
                    .print-header .subtitle {
                        color: #7f8c8d;
                        font-size: 14px;
                        margin-top: 5px;
                    }
                    
                    .report-item { 
                        margin-bottom: 30px; 
                        padding: 20px; 
                        border: 1px solid #ddd; 
                        border-radius: 8px;
                        page-break-inside: avoid;
                    }
                    
                    .report-item h3 {
                        color: #2c3e50;
                        border-bottom: 1px solid #eee;
                        padding-bottom: 10px;
                        margin-bottom: 15px;
                    }
                    
                    .info-grid { 
                        display: grid; 
                        grid-template-columns: repeat(2, 1fr); 
                        gap: 10px; 
                        margin-bottom: 20px;
                    }
                    
                    .info-item { 
                        margin-bottom: 10px; 
                        padding: 8px;
                        background: #f8f9fa;
                        border-radius: 4px;
                    }
                    
                    .total-score { 
                        background: #f0f0f0; 
                        padding: 15px; 
                        text-align: center; 
                        border-radius: 8px;
                        border: 1px solid #ddd;
                    }
                    
                    .score-details { 
                        display: flex; 
                        justify-content: space-around;
                        margin-top: 10px;
                    }
                    
                    .score-item {
                        text-align: center;
                    }
                    
                    .score-item .value {
                        font-size: 18px;
                        font-weight: bold;
                        display: block;
                        margin-bottom: 5px;
                    }
                    
                    .score-item .label {
                        font-size: 12px;
                        color: #666;
                    }
                    
                    .rating-faces { 
                        font-size: 1.2em; 
                        margin-left: 10px;
                    }
                    
                    .face-bad { color: #e74c3c; }
                    .face-ok { color: #f39c12; }
                    .face-good { color: #27ae60; }
                    
                    .print-footer {
                        border-top: 2px solid #667eea;
                        padding-top: 20px;
                        margin-top: 40px;
                        display: flex;
                        justify-content: space-between;
                        align-items: center;
                        font-size: 12px;
                        color: #666;
                    }
                    
                    .print-footer .psychologist-info {
                        display: flex;
                        align-items: center;
                        gap: 15px;
                    }
                    
                    .print-footer .psychologist-logo {
                        width: 40px;
                        height: 40px;
                        background: #667eea;
                        border-radius: 50%;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        color: white;
                        font-size: 16px;
                    }
                    
                    .print-footer .psychologist-text h4 {
                        margin: 0;
                        font-size: 14px;
                        color: #2c3e50;
                    }
                    
                    .print-footer .psychologist-text p {
                        margin: 0;
                        font-size: 12px;
                        color: #666;
                    }
                    
                    .print-footer .creator-info {
                        text-align: right;
                    }
                    
                    .print-footer .creator-info p {
                        margin: 2px 0;
                        color: #666;
                    }
                    
                    .print-date {
                        text-align: right;
                        color: #666;
                        font-size: 12px;
                        margin-bottom: 20px;
                    }
                    
                    @media print {
                        body { 
                            print-color-adjust: exact;
                            -webkit-print-color-adjust: exact;
                        }
                        
                        .report-item {
                            page-break-inside: avoid;
                            break-inside: avoid;
                        }
                        
                        .print-footer {
                            page-break-inside: avoid;
                            break-inside: avoid;
                        }
                    }
                </style>
            </head>
            <body>
                <div class="print-header">
                    <div class="logo-section">
                        <img src="logodivertido.jpg" alt="Logo da Empresa" class="logo-placeholder">
                        <div>
                            <h1>Sistema de ${reportTypeKeyword} </h1>
                            <p class="subtitle">An√°lise Profissional de Entrevistas</p>
                        </div>
                    </div>
                </div>
                
                <div class="print-date">
                    <strong>Data da Impress√£o:</strong> ${new Date().toLocaleDateString('pt-BR', { 
                        year: 'numeric', 
                        month: 'long', 
                        day: 'numeric',
                        hour: '2-digit',
                        minute: '2-digit'
                    })}
                </div>
                
                ${printContent}
                
                <div class="print-footer">
                    <div class="psychologist-info">
                        <div class="psychologist-logo">
                            <img src="psico.png" alt="Foto da Psic√≥loga" />
                        </div>
                        <div class="psychologist-text">
                            <h4>Sandra Rodrigues</h4>
                            <p>Psic√≥loga</p>
                        </div>
                    </div>
                    <div class="creator-info">
                        <p>Sistema Entrevistas</p>
                        <p><strong>Sistema - Entrevistas</strong></p>
                        <p>¬© 2025-war</p>
                    </div>
                </div>
            </body>
        </html>
    `);
    doc.close();

    iframe.onload = function() {
        iframe.contentWindow.focus();
        iframe.contentWindow.print();
        setTimeout(() => {
            document.body.removeChild(iframe);
        }, 1000);
    };
}
        function clearReport() {
            if (confirm('Tem certeza que deseja limpar todos os dados?')) {
                document.getElementById('reportData').value = '';
                document.getElementById('reportContainer').innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-chart-line"></i>
                        <h3>Aguardando Dados</h3>
                        <p>Cole os dados da entrevista de demiss√£o no campo acima e clique em "Processar Relat√≥rio"</p>
                    </div>
                `;
                reportData = [];
                sessionStorage.removeItem('reportData');
                sessionStorage.removeItem('reportInput');
                showNotification('Dados limpos com sucesso!', 'success');
            }
        }

        function showNotification(message, type) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                padding: 15px 25px;
                border-radius: 10px;
                color: white;
                font-weight: bold;
                z-index: 1000;
                animation: slideIn 0.3s ease-out;
                background: ${type === 'success' ? '#27ae60' : '#e74c3c'};
            `;
            notification.textContent = message;
            document.body.appendChild(notification);

            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        window.addEventListener('load', function() {
            const savedInput = sessionStorage.getItem('reportInput');
            const savedData = sessionStorage.getItem('reportData');
            
            if (savedInput) {
                document.getElementById('reportData').value = savedInput;
            }
            
            if (savedData) {
                reportData = JSON.parse(savedData);
                const reportHTML = generateReportHTML(reportData);
                document.getElementById('reportContainer').innerHTML = reportHTML;
            }
        });

        const style = document.createElement('style');
        style.textContent = `
            @keyframes slideIn {
                from { transform: translateX(100%); opacity: 0; }
                to { transform: translateX(0); opacity: 1; }
            }
        `;
        document.head.appendChild(style);
function getScoreColor(score) {
    if (score >= 4) return '#27ae60'; // Verde
    if (score >= 3) return '#f39c12'; // Laranja
    return '#e74c3c'; // Vermelho
}

function getBenefitsClassification(score) {
    if (score >= 4.5) return 'Excelente';
    if (score >= 4) return 'Muito bom';
    if (score >= 3) return 'Bom';
    if (score >= 2) return 'Regular';
    return 'Ruim';
}
    </script>
</body>
</html>
