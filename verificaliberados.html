<!DOCTYPE html>
<html lang="pt">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üìÇ Pastas Vazias √ó Liberados Pendentes</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #0f2027 0%, #203a43 50%, #2c5364 100%);
            min-height: 100vh;
            padding: 30px 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        h1 {
            color: white;
            text-align: center;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .subtitle {
            color: rgba(255,255,255,0.9);
            text-align: center;
            margin-bottom: 40px;
            font-size: 1.2rem;
        }

        .main-panel {
            background: white;
            border-radius: 30px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.4);
        }

        .lists-container {
            display: flex;
            gap: 30px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .list-card {
            flex: 1;
            min-width: 400px;
            background: #f8faff;
            border-radius: 20px;
            padding: 20px;
            border: 2px solid #e0e7ff;
        }

        .list-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 2px solid #e0e7ff;
        }

        .list-header h2 {
            color: #2d3748;
            font-size: 1.3rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .badge-info {
            background: #2c5364;
            color: white;
            padding: 4px 12px;
            border-radius: 30px;
            font-size: 0.8rem;
        }

        .list-count {
            background: #2c5364;
            color: white;
            padding: 5px 15px;
            border-radius: 30px;
            font-weight: 600;
        }

        .list-area {
            width: 100%;
            height: 350px;
            padding: 15px;
            border: 2px solid #e0e7ff;
            border-radius: 15px;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            line-height: 1.5;
            resize: vertical;
            outline: none;
            background: white;
        }

        .list-area:focus {
            border-color: #2c5364;
            box-shadow: 0 0 0 3px rgba(44,83,100,0.1);
        }

        .action-bar {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin: 30px 0;
            flex-wrap: wrap;
        }

        .btn-primary {
            background: linear-gradient(135deg, #2c5364 0%, #0f2027 100%);
            color: white;
            border: none;
            padding: 15px 40px;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 10px 20px rgba(44,83,100,0.3);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 30px rgba(44,83,100,0.4);
        }

        .btn-secondary {
            background: white;
            border: 2px solid #2c5364;
            color: #2c5364;
            padding: 13px 30px;
            border-radius: 50px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-secondary:hover {
            background: #2c5364;
            color: white;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin: 30px 0;
        }

        .stat-card {
            background: linear-gradient(135deg, #f8faff, white);
            border-radius: 20px;
            padding: 25px;
            text-align: center;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05);
            border: 1px solid #e0e7ff;
        }

        .stat-value {
            font-size: 2.5rem;
            font-weight: 700;
            color: #2c5364;
            line-height: 1;
            margin-bottom: 10px;
        }

        .stat-label {
            color: #718096;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .result-section {
            margin-top: 30px;
        }

        .result-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            border: 3px solid #f6ad55;
        }

        .result-header {
            padding: 20px;
            color: white;
            font-weight: 600;
            font-size: 1.3rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, #ed8936, #dd6b20);
        }

        .result-count {
            background: rgba(255,255,255,0.2);
            padding: 5px 20px;
            border-radius: 40px;
            font-size: 1rem;
        }

        .result-list {
            max-height: 500px;
            overflow-y: auto;
            padding: 15px;
        }

        .result-item {
            padding: 20px;
            border-bottom: 1px solid #e0e7ff;
            display: flex;
            align-items: center;
            gap: 20px;
            transition: all 0.2s;
            background: #fffaf0;
        }

        .result-item:hover {
            background: #feebc8;
            transform: translateX(5px);
        }

        .item-number {
            background: #ed8936;
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            font-size: 1.1rem;
        }

        .item-name {
            flex: 1;
        }

        .item-name strong {
            font-size: 1.2rem;
            color: #2d3748;
        }

        .item-details {
            font-size: 0.9rem;
            color: #718096;
            margin-top: 8px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .badge-pasta {
            background: #2c5364;
            color: white;
            padding: 3px 12px;
            border-radius: 30px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .badge-liberado {
            background: #48bb78;
            color: white;
            padding: 3px 12px;
            border-radius: 30px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .badge-equivalencia {
            background: #f6ad55;
            color: #744210;
            padding: 3px 12px;
            border-radius: 30px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .success-message {
            text-align: center;
            padding: 40px;
            color: #48bb78;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .equivalencias-panel {
            margin-top: 30px;
            background: #ebf8ff;
            border-radius: 15px;
            padding: 20px;
            border-left: 5px solid #2c5364;
        }

        .equivalencias-title {
            color: #2c5364;
            font-size: 1.1rem;
            margin-bottom: 15px;
            font-weight: 600;
        }

        .equivalencias-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 10px;
        }

        .equivalencia-item {
            background: white;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 0.9rem;
            border: 1px solid #cbd5e0;
        }

        .equivalencia-item strong {
            color: #2c5364;
        }

        @media (max-width: 900px) {
            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üìÇ Pastas Vazias √ó Liberados Pendentes</h1>
        <div class="subtitle">Identifique quais itens j√° liberados (B) ainda est√£o como pastas vazias (A)</div>

        <div class="main-panel">
            <!-- Listas de entrada -->
            <div class="lists-container">
                <!-- Pastas Vazias (do sistema) -->
                <div class="list-card">
                    <div class="list-header">
                        <h2>
                            üìÅ A - PASTAS VAZIAS
                            <span class="badge-info">Ignora # e XP</span>
                        </h2>
                        <div class="list-count" id="countPastas">0</div>
                    </div>
                    <textarea class="list-area" id="pastasInput" placeholder="Cole o relat√≥rio de pastas vazias...">‚ùå PASTAS SEM ARQUIVOS (33)
#CT-e
#Postos incorporados e sem movimento
Abar√© (Ib√≥)
Cambu√≠ Rodovia
Cambu√≠ Urbano 2
Central ADM
Contagem Norte
Contagem Sul
Cordeir√≥polis
Ib√≥
Igaratinga
Itatiaiu√ßu
Itatiba Urbano 1
Jacare√≠
Jaguaquara
JK
Joia
Miracatu 3
Planalto
Posto 99
Santo Estev√£o 2
Santo Estev√£o 3
S√£o Gon√ßalo Rodovia 3
S√£o Gon√ßalo Urbano 1
XP Transportes Bahia
XP Transportes Cear√°
XP Transportes Goi√°s
XP Transportes Matriz
XP Transportes Par√°
XP Transportes Rio de Janeiro
XP Transportes S√£o Paulo
XP Transportes Sergipe
XP Transportes Tocantins</textarea>
                </div>

                <!-- Liberados (pessoal LMC) -->
                <div class="list-card">
                    <div class="list-header">
                        <h2>
                            ‚úÖ B - LIBERADOS LMC
                            <span class="badge-info">Com equival√™ncias</span>
                        </h2>
                        <div class="list-count" id="countLiberados">0</div>
                    </div>
                    <textarea class="list-area" id="liberadosInput" placeholder="Cole a lista de liberados...">*Lorena
*Frei Inoc√™ncio
*Luz
*Valen√ßa
*Barra Mansa Sul
*Cachoeira do Paje√∫
*S√£o Jorge
*Betim 2
*Russas
*Itapeva
*Pouso Alegre Rodovia 
*Turim
*Betim 1
*Alian√ßa
*DP2
*DP1
*Cambui Urbano 1
*Divisa Alegre 1
*Itaguara
*Salinas 
*Fuma√ßa
*Itatiaiu√ßu
*Jk
*Cambui Rodovia
S√£o Gon√ßalo Urbano 1, S√£o Gon√ßalo Urbano 2, Bragan√ßa Urbano, Guara Urbano 3, Atibaia Rodovia, Pinda Sul, Igaratinga, Pouso Alegre Urbano 1, Pouso Alegre Urbano 2, Pouso Alegre Urbano 3, Jacare√≠, Caetan√≥polis, Santo Estev√£o 3
Atibaia Urb
Muriae
Juiz de Fora Rod
Santo Estev√£o 
Itaberaba
Vitoria da Conquista
Barreiras
Barra Mansa Norte 
Inhapim 
Montes Claros 
Extrema
Inconfidentes
Vargem
Tocantins
Camanducaia 1
Camanducaia 2 
Bueno Brand√£o
Guara 2
S√£o Crist√≥v√£o
Aparecida
Miracatu Norte
Leme
Carm√≥polis
Divisa Alegre 2
S√£o Gon√ßalo Rod 2
Santo Estev√£o 2
Pinda Norte
Senador Amaral
Juiz de fora urbano
Ouro Fino
S√£o Jos√© dos Campos
S√£o Gon√ßalo Rodovia 1
Jaguaquara
Paraopeba
Contagem Fern√£o Dias 
Lafaiete
Planalto
Sales Oliveira</textarea>
                </div>
            </div>

            <!-- Barra de a√ß√µes -->
            <div class="action-bar">
                <button class="btn-primary" id="btnVerificar">
                    <span>üîç</span> IDENTIFICAR PENDENTES DE C√ìPIA
                </button>
                <button class="btn-secondary" id="btnLimpar">üóëÔ∏è Limpar</button>
                <button class="btn-secondary" id="btnCopiar">üìã Copiar Lista</button>
            </div>

            <!-- Estat√≠sticas -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="totalPastas">0</div>
                    <div class="stat-label">Pastas Vazias (A)</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalLiberados">0</div>
                    <div class="stat-label">Itens Liberados (B)</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalCorrespondencias">0</div>
                    <div class="stat-label">Correspond√™ncias</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="totalPendentes">0</div>
                    <div class="stat-label">PENDENTES DE C√ìPIA</div>
                </div>
            </div>

            <!-- RESULTADO PRINCIPAL: Liberados que est√£o como pastas vazias -->
            <div class="result-section">
                <div class="result-card">
                    <div class="result-header">
                        <span>‚ö†Ô∏è LIBERADOS QUE AINDA EST√ÉO COMO PASTAS VAZIAS (PENDENTES DE C√ìPIA)</span>
                        <span class="result-count" id="countPendentes">0</span>
                    </div>
                    <div class="result-list" id="pendentesLista">
                        <div class="success-message">Nenhum item pendente! Todos os liberados j√° foram copiados. ‚úÖ</div>
                    </div>
                </div>
            </div>

            <!-- Painel de equival√™ncias -->
            <div class="equivalencias-panel">
                <div class="equivalencias-title">üîÑ Equival√™ncias consideradas (nome liberado ‚Üí nome da pasta):</div>
                <div class="equivalencias-grid">
                    <div class="equivalencia-item"><strong>Itapeva</strong> ‚Üí Paulinho</div>
                    <div class="equivalencia-item"><strong>DP1</strong> ‚Üí Dom Pedro 1</div>
                    <div class="equivalencia-item"><strong>DP2</strong> ‚Üí Dom Pedro 2</div>
                    <div class="equivalencia-item"><strong>Bragan√ßa Urbano</strong> ‚Üí Bragan√ßa Urbano 1</div>
                    <div class="equivalencia-item"><strong>Guara 2</strong> ‚Üí Guara Urbano 2</div>
                    <div class="equivalencia-item"><strong>Camanducaia 1</strong> ‚Üí Camanducaia Urbano 1</div>
                    <div class="equivalencia-item"><strong>Camanducaia 2</strong> ‚Üí Camanducaia Urbano 2</div>
                    <div class="equivalencia-item"><strong>Atibaia Rodovia</strong> ‚Üí Atibaia</div>
                    <div class="equivalencia-item"><strong>Atibaia Urb</strong> ‚Üí Atibaia Urbano Filial</div>
                    <div class="equivalencia-item"><strong>Pinda Sul/Norte</strong> ‚Üí Pinda</div>
                    <div class="equivalencia-item"><strong>S√£o Gon√ßalo Rod 2</strong> ‚Üí S√£o Gon√ßalo Rodovia 2</div>
                    <div class="equivalencia-item"><strong>Divisa Alegre 1</strong> ‚Üí Divisa Alegre</div>
                    <div class="equivalencia-item"><strong>Cachoeira do Paje√∫</strong> ‚Üí Paje√∫</div>
                    <div class="equivalencia-item"><strong>Lafaiete</strong> ‚Üí Conselheiro Lafaiete</div>
                    <div class="equivalencia-item"><strong>Betim 1</strong> ‚Üí Betim</div>
                    <div class="equivalencia-item"><strong>Tocantins</strong> ‚Üí Para√≠so do Tocantins</div>
                    <div class="equivalencia-item"><strong>Santo Estev√£o</strong> ‚Üí Santo Estev√£o 1</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Mapa de equival√™ncias (nome liberado ‚Üí nome da pasta)
        const equivalencias = new Map([
            // Itapeva = Paulinho
            ['itapeva', 'PAULINHO'],
            
            // DP1 = Dom Pedro 1
            ['dp1', 'DOM PEDRO 1'],
            ['dp2 ou dom pedro 1', 'DOM PEDRO 1'],
            
            // DP2 = Dom Pedro 2
            ['dp2', 'DOM PEDRO 2'],
            ['dp1 ou dom pedro 2', 'DOM PEDRO 2'],
            
            // Bragan√ßa Urbano = Bragan√ßa Urbano 1
            ['bragan√ßa urbano', 'BRAGAN√áA URBANO 1'],
            
            // Guara 2 = Guara Urbano 2
            ['guara 2', 'GUARA URBANO 2'],
            
            // Camanducaia 1 = Camanducaia Urbano 1
            ['camanducaia 1', 'CAMANDUCAIA URBANO 1'],
            ['camanducaia urbano 1', 'CAMANDUCAIA URBANO 1'],
            
            // Camanducaia 2 = Camanducaia Urbano 2
            ['camanducaia 2', 'CAMANDUCAIA URBANO 2'],
            ['camanducaia urbano 2', 'CAMANDUCAIA URBANO 2'],
            
            // Atibaia Rodovia = Atibaia
            ['atibaia rodovia', 'ATIBAIA'],
            
            // Atibaia Urb = Atibaia Urbano Filial
            ['atibaia urb', 'ATIBAIA URBANO FILIAL'],
            ['atibaia urbano', 'ATIBAIA URBANO FILIAL'],
            
            // Pinda Sul/Norte = Pinda
            ['pinda sul', 'PINDA'],
            ['pinda norte', 'PINDA'],
            
            // S√£o Gon√ßalo Rod 2 = S√£o Gon√ßalo Rodovia 2
            ['s√£o gon√ßalo rod 2', 'S√ÉO GON√áALO RODOVIA 2'],
            
            // Divisa Alegre 1 = Divisa Alegre
            ['divisa alegre 1', 'DIVISA ALEGRE'],
            
            // Cachoeira do Paje√∫ = Paje√∫
            ['cachoeira do paje√∫', 'PAJE√ö'],
            
            // Lafaiete = Conselheiro Lafaiete
            ['lafaiete', 'CONSELHEIRO LAFAIETE'],
            
            // Betim 1 = Betim
            ['betim 1', 'BETIM'],
            
            // Tocantins = Para√≠so do Tocantins
            ['tocantins', 'PARA√çSO DO TOCANTINS'],
            
            // Santo Estev√£o = Santo Estev√£o 1
            ['santo estev√£o', 'SANTO ESTEV√ÉO 1'],
            
            // Varia√ß√µes comuns
            ['muriae', 'MURIA√â'],
            ['vitoria da conquista', 'VIT√ìRIA DA CONQUISTA'],
            ['barra mansa norte', 'BARRA MANSA NORTE'],
            ['barra mansa sul', 'BARRA MANSA SUL'],
            ['montes claros', 'MONTES CLAROS'],
            ['inconfidentes', 'INCONFIDENTES'],
            ['vargem', 'VARGEM'],
            ['bueno brand√£o', 'BUENO BRAND√ÉO'],
            ['s√£o crist√≥v√£o', 'S√ÉO CRIST√ìV√ÉO FILIAL'],
            ['aparecida', 'APARECIDA'],
            ['miracatu norte', 'MIRACATU NORTE'],
            ['leme', 'LEME'],
            ['carm√≥polis', 'CARM√ìPOLIS'],
            ['divisa alegre 2', 'DIVISA ALEGRE 2'],
            ['santo estev√£o 2', 'SANTO ESTEV√ÉO 2'],
            ['santo estev√£o 3', 'SANTO ESTEV√ÉO 3'],
            ['senador amaral', 'SENADOR AMARAL'],
            ['juiz de fora urbano', 'JUIZ DE FORA URBANO'],
            ['ouro fino', 'OURO FINO'],
            ['s√£o jos√© dos campos', 'S√ÉO JOS√â DOS CAMPOS'],
            ['s√£o gon√ßalo rodovia 1', 'S√ÉO GON√áALO RODOVIA 1'],
            ['paraopeba', 'PARAOPEBA'],
            ['contagem fern√£o dias', 'CONTAGEM FERN√ÉO DIAS'],
            ['planalto', 'PLANALTO'],
            ['sales oliveira', 'SALES OLIVEIRA'],
            ['pouso alegre urbano 1', 'POUSO ALEGRE URBANO 1'],
            ['pouso alegre urbano 2', 'POUSO ALEGRE URBANO 2'],
            ['pouso alegre urbano 3', 'POUSO ALEGRE URBANO 3'],
            ['cambu√≠ rodovia', 'CAMBU√ç RODOVIA'],
            ['cambu√≠ urbano 1', 'CAMBU√ç URBANO 1'],
            ['igaratinga', 'IGARATINGA'],
            ['jacare√≠', 'JACARE√ç'],
            ['jk', 'JK'],
            ['posto 99', 'POSTO 99'],
            ['russas', 'RUSSAS'],
            ['turim', 'TURIM'],
            ['salinas', 'SALINAS'],
            ['itaguara', 'ITAGUARA'],
            ['itatiaiu√ßu', 'ITATIAIU√áU'],
            ['luz', 'LUZ'],
            ['frei inoc√™ncio', 'FREI INOC√äNCIO'],
            ['lorena', 'LORENA'],
            ['valen√ßa', 'VALEN√áA'],
            ['s√£o jorge', 'S√ÉO JORGE'],
            ['pouso alegre rodovia', 'POUSO ALEGRE RODOVIA'],
            ['alian√ßa', 'ALIAN√áA'],
            ['inhapim', 'INHAPIM'],
            ['extrema', 'EXTREMA'],
            ['caetan√≥polis', 'CAETAN√ìPOLIS']
        ]);

        function normalizar(str) {
            if (!str) return '';
            return str.normalize("NFD")
                     .replace(/[\u0300-\u036f]/g, "")
                     .replace(/[\(\)]/g, '')
                     .replace(/[-\s]+/g, ' ')
                     .toLowerCase()
                     .trim();
        }

        function extrairPastas(texto) {
            const linhas = texto.split('\n');
            const pastas = [];
            
            linhas.forEach(linha => {
                let linhaLimpa = linha.trim();
                
                // Ignora linhas vazias
                if (!linhaLimpa) return;
                
                // Ignora linhas que come√ßam com # ou XP
                if (linhaLimpa.startsWith('#')) return;
                if (linhaLimpa.startsWith('XP')) return;
                if (linhaLimpa.includes('PASTAS SEM ARQUIVOS')) return;
                if (linhaLimpa.includes('Total Pastas')) return;
                if (linhaLimpa.includes('Com Arquivos')) return;
                if (linhaLimpa.includes('Atualiza√ß√µes')) return;
                if (linhaLimpa.includes('Vazios')) return;
                if (linhaLimpa.startsWith('‚ùå')) return;
                
                // Remove marcadores como ‚ùå, n√∫meros, etc
                let item = linhaLimpa.replace(/^[‚ùå\d\s\.\-\*]+/, '').trim();
                
                if (item && item.length > 0) {
                    pastas.push(item.toUpperCase());
                }
            });
            
            return [...new Set(pastas)]; // Remove duplicatas
        }

        function extrairLiberados(texto) {
            const linhas = texto.split('\n');
            const liberados = [];
            const liberadosNorm = new Set();
            
            linhas.forEach(linha => {
                let linhaLimpa = linha.trim();
                
                // Remove asteriscos do in√≠cio
                linhaLimpa = linhaLimpa.replace(/^\*+/, '').trim();
                
                // Ignora linhas vazias
                if (!linhaLimpa) return;
                
                // Trata linhas com v√≠rgulas (ex: "S√£o Gon√ßalo Urbano 1, S√£o Gon√ßalo Urbano 2")
                if (linhaLimpa.includes(',')) {
                    const partes = linhaLimpa.split(',').map(p => p.trim());
                    partes.forEach(parte => {
                        if (parte) {
                            const parteNorm = normalizar(parte);
                            if (!liberadosNorm.has(parteNorm)) {
                                liberadosNorm.add(parteNorm);
                                liberados.push(parte);
                            }
                        }
                    });
                } else {
                    const itemNorm = normalizar(linhaLimpa);
                    if (!liberadosNorm.has(itemNorm)) {
                        liberadosNorm.add(itemNorm);
                        liberados.push(linhaLimpa);
                    }
                }
            });
            
            return liberados;
        }

        function resolverEquivalencia(item) {
            const itemNorm = normalizar(item);
            
            for (let [sinonimo, original] of equivalencias) {
                if (itemNorm.includes(normalizar(sinonimo))) {
                    return original;
                }
            }
            
            return item.toUpperCase();
        }

        function identificarPendentes() {
            const textoPastas = document.getElementById('pastasInput').value;
            const textoLiberados = document.getElementById('liberadosInput').value;
            
            // Extrai listas
            const pastas = extrairPastas(textoPastas);
            const liberadosRaw = extrairLiberados(textoLiberados);
            
            // Cria mapa de pastas para busca r√°pida
            const pastasSet = new Set(pastas.map(p => normalizar(p)));
            
            // Para cada liberado, resolve equival√™ncia e verifica se est√° nas pastas
            const correspondencias = [];
            const pendentes = [];
            
            liberadosRaw.forEach(item => {
                const nomeResolvido = resolverEquivalencia(item);
                const itemNorm = normalizar(nomeResolvido);
                
                // Verifica se este liberado (resolvido) est√° nas pastas vazias
                if (pastasSet.has(itemNorm)) {
                    // ENCONTROU: √© um liberado que est√° como pasta vazia ‚Üí PENDENTE DE C√ìPIA
                    pendentes.push({
                        original: item,
                        resolvido: nomeResolvido,
                        tipo: 'pendente'
                    });
                }
                
                // Para estat√≠stica de correspond√™ncias (qualquer match)
                for (let pasta of pastas) {
                    if (normalizar(pasta) === itemNorm) {
                        correspondencias.push({
                            liberado: item,
                            pasta: pasta
                        });
                        break;
                    }
                }
            });
            
            // Atualiza estat√≠sticas
            document.getElementById('countPastas').innerText = pastas.length;
            document.getElementById('countLiberados').innerText = liberadosRaw.length;
            document.getElementById('totalPastas').innerText = pastas.length;
            document.getElementById('totalLiberados').innerText = liberadosRaw.length;
            document.getElementById('totalCorrespondencias').innerText = correspondencias.length;
            document.getElementById('totalPendentes').innerText = pendentes.length;
            document.getElementById('countPendentes').innerText = pendentes.length;
            
            // Renderiza lista de pendentes
            renderizarPendentes(pendentes);
        }

        function renderizarPendentes(pendentes) {
            const container = document.getElementById('pendentesLista');
            
            if (pendentes.length === 0) {
                container.innerHTML = '<div class="success-message">Nenhum item pendente! Todos os liberados j√° foram copiados. ‚úÖ</div>';
                return;
            }
            
            let html = '';
            pendentes.forEach((item, index) => {
                html += `
                    <div class="result-item">
                        <div class="item-number">${index + 1}</div>
                        <div class="item-name">
                            <strong>${item.original}</strong>
                            <div class="item-details">
                                <span class="badge-liberado">‚úì LIBERADO</span>
                                <span class="badge-pasta">üìÅ PASTA VAZIA: ${item.resolvido}</span>
                                ${item.original.toUpperCase() !== item.resolvido ? 
                                    `<span class="badge-equivalencia">‚Ü¶ ${item.original} ‚Üí ${item.resolvido}</span>` : ''}
                            </div>
                        </div>
                    </div>
                `;
            });
            
            container.innerHTML = html;
        }

        function limparTudo() {
            document.getElementById('pastasInput').value = '';
            document.getElementById('liberadosInput').value = '';
            document.getElementById('countPastas').innerText = '0';
            document.getElementById('countLiberados').innerText = '0';
            document.getElementById('totalPastas').innerText = '0';
            document.getElementById('totalLiberados').innerText = '0';
            document.getElementById('totalCorrespondencias').innerText = '0';
            document.getElementById('totalPendentes').innerText = '0';
            document.getElementById('countPendentes').innerText = '0';
            document.getElementById('pendentesLista').innerHTML = '<div class="success-message">Cole as listas para verificar</div>';
        }

        function copiarResultado() {
            const itens = document.querySelectorAll('#pendentesLista .result-item');
            if (itens.length === 0) {
                alert('N√£o h√° itens pendentes para copiar!');
                return;
            }
            
            let texto = 'üìã LIBERADOS PENDENTES DE C√ìPIA (j√° liberados mas ainda como pastas vazias):\n\n';
            itens.forEach((item, index) => {
                const nome = item.querySelector('.item-name strong').innerText;
                texto += `${index + 1}. ${nome}\n`;
            });
            
            navigator.clipboard.writeText(texto).then(() => {
                alert('Lista de pendentes copiada!');
            }).catch(() => {
                alert('Erro ao copiar. Selecione manualmente.');
            });
        }

        // Event listeners
        document.getElementById('btnVerificar').addEventListener('click', identificarPendentes);
        document.getElementById('btnLimpar').addEventListener('click', limparTudo);
        document.getElementById('btnCopiar').addEventListener('click', copiarResultado);
        
        // Inicializa
        window.onload = identificarPendentes;
    </script>
</body>
</html>